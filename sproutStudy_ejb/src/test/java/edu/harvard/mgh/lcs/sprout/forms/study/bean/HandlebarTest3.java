package edu.harvard.mgh.lcs.sprout.forms.study.bean;

import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.github.jknack.handlebars.*;
import com.github.jknack.handlebars.context.FieldValueResolver;
import com.github.jknack.handlebars.context.JavaBeanValueResolver;
import com.github.jknack.handlebars.context.MapValueResolver;
import com.github.jknack.handlebars.context.MethodValueResolver;
import edu.harvard.mgh.lcs.sprout.forms.transform.handlebars.Helpers;
import org.junit.Test;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.security.SecureRandom;

public class HandlebarTest3 {

	 private SecureRandom random = new SecureRandom();

	private StringBuilder template = new StringBuilder();


	@Test
	public void test() {

		init();
		try {

			Handlebars handlebars = new Handlebars();

//			handlebars.registerHelper("compare", , function (context) {
//				return 'Hello ' + context;
//			})


//			InputStream inputStream = this.getClass().getResourceAsStream("/edu/harvard/mgh/lcs/sprout/forms/transform/handlebars/helpers/compare.js");


//			String f = getStringFromInputStream(inputStream);
//			System.out.println("f = " + f);

			handlebars.registerHelpers(new Helpers());



			String json = "{\"sprout\":{\"userId\":\"5445477@mgh\",\"inboxId\":\"7736\",\"instanceId\":\"CE030BF0-691D-42D4-A4B9-510C93F08E98\",\"currentStep\":\"step21\",\"currentInput\":\"86705\",\"validationStatus\":\"\",\"initStep\":\"step21\",\"initInput\":\"initialized\",\"submissionDate\":\"March 1, 2016 2:38 PM\",\"expirationDate\":\"\",\"lockKey\":\"5F4764DC-A539-41D1-AEBB-61A4E433138E\"},\"form\":{\"id\":\"459\",\"version\":\"13\",\"mode\":\"\"},\"frm_nuclear_cardiolo_1\":{\"procedure_name1\":\"NC.NC.PRFPHRMM\",\"aborted\":\"\",\"order_no\":\"200027\",\"procedure_code\":\"NC.NC.PRFPHRMM\",\"pt_name_grid\":[{\"patient_last_name\":\"TEST\"},{\"patent_first_name\":\"TEST\"},{\"patient_middle_initial\":\"\"}],\"mrn\":\"5445477\",\"epic_dob\":\"19791001\",\"dob\":\"10/01/1979\",\"age\":\"36\",\"gender\":{\"name\":\"Female\",\"value\":\"F\"},\"height\":\"68\",\"weight\":\"168\",\"weight_kg\":\"76.2\",\"bsa\":\"1.9\",\"bmi\":\"26\",\"pt_location_grid\":[{\"patient_location\":{\"name\":\"\",\"value\":\"\"}},{\"floor\":\"\"},{\"lab\":{\"name\":\"\",\"value\":\"\"}}],\"fund_number\":\"\",\"stress_start_time\":\"\",\"ordering_md_first\":\"HENRY\",\"ordering_md_last\":\"GEWIRTZ\",\"ordering_md\":\"HENRY GEWIRTZ\",\"rendering_provider\":{\"name\":\"\",\"value\":\"\"},\"billing_provider\":{\"name\":\"\",\"value\":\"\"},\"staff_nuclear_cardiologist\":{\"name\":\"Ahmed Tawakol, MD\",\"value\":\"at018\"},\"staff_radiologist\":{\"name\":\"Henry Gewirtz, MD\",\"value\":\"hg027\"},\"add_rnmd\":\"\",\"stress_tester\":\"\",\"nuclear_tech\":\"\",\"typed_by\":\"\",\"purpose_grid\":[{\"p_arrhythmia\":{\"name\":\"Assess arryhthmia\",\"value\":\"1\"}},{\"p_angio\":{\"name\":\"Angiographic correlation\",\"value\":\"1\"}},{\"p_baseline\":{\"name\":\"Baseline exercise\",\"value\":\"\"}},{\"p_chemo\":{\"name\":\"Chemotherapy\",\"value\":\"\"}},{\"p_chest_pain\":{\"name\":\"Chest pain\",\"value\":\"\"}},{\"p_diagnosis_ischemia\":{\"name\":\"Diagnosis of ischemia\",\"value\":\"\"}},{\"p_functional\":{\"name\":\"Evaluate functional capacity\",\"value\":\"\"}},{\"p_evaluate_ischemia\":{\"name\":\"Evaluate ischemia\",\"value\":\"\"}},{\"p_lvfunction\":{\"name\":\"Evaluate LV function\",\"value\":\"\"}},{\"p_multiple_risks\":{\"name\":\"Evaluate multiple risks\",\"value\":\"\"}},{\"p_fup_cabg\":{\"name\":\"Follow-up CABG\",\"value\":\"\"}},{\"p_fup_mi\":{\"name\":\"Follow-up MI\",\"value\":\"\"}},{\"p_fup_ptca\":{\"name\":\"Follow-up PTCA/Stent\",\"value\":\"\"}},{\"p_fup_preop\":{\"name\":\"Preop (non-cardiac)\",\"value\":\"\"}},{\"p_research\":{\"name\":\"Research\",\"value\":\"\"}},{\"p_screening\":{\"name\":\"Screening\",\"value\":\"\"}},{\"p_qtc\":{\"name\":\"Assess QTc, rest and stress\",\"value\":\"\"}},{\"p_viability\":{\"name\":\"Assess viability\",\"value\":\"\"}}],\"risk_factors_composite\":[{\"rf_diabetes\":{\"name\":\"Diabetes\",\"value\":\"\"}},{\"rf_dyslipidemia\":{\"name\":\"Dyslipidemia\",\"value\":\"\"}},{\"rf_hypertension\":{\"name\":\"Hypertension\",\"value\":\"1\"}},{\"rf_family_history\":{\"name\":\"Family History\",\"value\":\"\"}},{\"rf_smoking_past\":{\"name\":\"Smoking, past\",\"value\":\"\"}},{\"rf_smoking_pres\":{\"name\":\"Smoking, present\",\"value\":\"\"}},{\"rf_coronary_ca\":{\"name\":\"Coronary calcium\",\"value\":\"\"}},{\"rf_hscrp\":{\"name\":\"Elevated hsCRP\",\"value\":\"\"}},{\"rf_menopause\":{\"name\":\"Menopause\",\"value\":\"\"}},{\"rf_obesity\":{\"name\":\"Obesity\",\"value\":\"\"}}],\"history_composite\":[{\"hx_mi_current\":{\"name\":\"MI, current\",\"value\":\"\"}},{\"hx_mi_old\":{\"name\":\"MI, old\",\"value\":\"\"}},{\"hx_cp_atypical\":{\"name\":\"CP, atypical\",\"value\":\"1\"}},{\"hx_cp_typical\":{\"name\":\"CP, typical\",\"value\":\"\"}},{\"hx_angina_atypical\":{\"name\":\"Atypical angina\",\"value\":\"\"}},{\"hx_angina_typical\":{\"name\":\"Typical angina\",\"value\":\"\"}},{\"hx_dyspnea\":{\"name\":\"Dyspnea\",\"value\":\"\"}},{\"hx_lung_disease\":{\"name\":\"Lung disease\",\"value\":\"\"}},{\"hx_chf\":{\"name\":\"CHF\",\"value\":\"\"}},{\"hx_palpitations\":{\"name\":\"Palpitations\",\"value\":\"\"}},{\"hx_dizzy\":{\"name\":\"Lightheaded/dizzy\",\"value\":\"\"}},{\"hx_substance_abuse\":{\"name\":\"Substance abuse\",\"value\":\"\"}},{\"hx_syncope\":{\"name\":\"Syncope\",\"value\":\"\"}},{\"hx_presyncope\":{\"name\":\"Pre-syncope\",\"value\":\"\"}},{\"hx_arrhythmia\":{\"name\":\"Arrhythmia\",\"value\":\"\"}},{\"hx_pvd\":{\"name\":\"PVD/Carotid disease\",\"value\":\"\"}},{\"hx_device\":{\"name\":\"Implantable device\",\"value\":\"\"}},{\"hx_fatigue\":{\"name\":\"Fatigue\",\"value\":\"\"}},{\"hx_cerebro_disease\":{\"name\":\"Cerebrovascular disease\",\"value\":\"\"}},{\"hx_thrombolysis\":{\"name\":\"Thrombolysis\",\"value\":\"\"}},{\"hx_valve_disease\":{\"name\":\"Valvular abnormalities\",\"value\":\"\"}},{\"hx_kidney_disease\":{\"name\":\"Kidney disease\",\"value\":\"\"}},{\"hx_other_cardiac_disease\":{\"name\":\"Other heart disease\",\"value\":\"\"}},{\"hx_cancer\":{\"name\":\"Cancer\",\"value\":\"\"}},{\"hx_etoh\":{\"name\":\"ETOH\",\"value\":\"\"}},{\"hx_seizures\":{\"name\":\"Seizures\",\"value\":\"\"}},{\"hx_viagra\":{\"name\":\"Viagra\",\"value\":\"\"}},{\"hx_viagra_last_dose\":\"\"}],\"cath\":{\"name\":\"Cath\",\"value\":\"1\"},\"cath_composite\":[{\"cath_date\":\"\"},{\"cath_norm\":{\"name\":\"Normal Cors\",\"value\":\"\"}},{\"cath_cad\":{\"name\":\"CAD\",\"value\":\"1\"}},{\"cath_lad\":{\"name\":\"LAD\",\"value\":\"\"}},{\"cath_cx\":{\"name\":\"Cx\",\"value\":\"\"}},{\"cath_rca\":{\"name\":\"RCA\",\"value\":\"\"}},{\"cath_lm\":{\"name\":\"LM\",\"value\":\"\"}}],\"cabg\":{\"name\":\"CABG\",\"value\":\"\"},\"cabg_composite\":[{\"cabg_date\":\"\"},{\"cabg_lad\":{\"name\":\"LAD\",\"value\":\"\"}},{\"cabg_cx\":{\"name\":\"Cx\",\"value\":\"\"}},{\"cabg_rca\":{\"name\":\"RCA\",\"value\":\"\"}},{\"cabg_lm\":{\"name\":\"LM\",\"value\":\"\"}}],\"ptca\":{\"name\":\"PTCA/Stent\",\"value\":\"\"},\"ptca_composite\":[{\"ptca_date\":\"\"},{\"ptca_lad\":{\"name\":\"LAD\",\"value\":\"\"}},{\"ptca_cx\":{\"name\":\"Cx\",\"value\":\"\"}},{\"ptca_rca\":{\"name\":\"RCA\",\"value\":\"\"}},{\"ptca_lm\":{\"name\":\"LM\",\"value\":\"\"}}],\"primary_dx\":{\"name\":\"CAD\",\"value\":\"cad\"},\"secondary_dx\":{\"name\":\"\",\"value\":\"\"},\"other_dx\":\"\",\"medications\":{\"name\":\"Yes\",\"value\":\"1\"},\"min_medication_name\":\"Advair\",\"min_medication_code\":\"adv\",\"medications_table\":[{\"medication_name\":\"Zoloft\"}],\"medication_code\":\"adv\",\"medications_other\":\"other\",\"pain_in_other\":\"\",\"pain_refer_composite\":[{\"pain_to_note\":{\"name\":\"Progress note\",\"value\":\"\"}},{\"pain_to_chart\":{\"name\":\"Medication records\",\"value\":\"\"}},{\"pain_to_flow\":{\"name\":\"Flow chart\",\"value\":\"\"}}],\"pain_perf_by\":\"\",\"pain_location\":{\"name\":\"\",\"value\":\"\"},\"pain_comment\":\"\",\"pain_ref_composite\":[{\"pain_ref_pcp\":{\"name\":\"PCP\",\"value\":\"\"}},{\"pain_ref_ed\":{\"name\":\"ED\",\"value\":\"\"}},{\"pain_ref_other\":{\"name\":\"Other\",\"value\":\"\"}}],\"pain_meds\":{\"name\":\"Medication\",\"value\":\"\"},\"pain_treat_other\":\"\",\"pain_reasses_composite\":[{\"pain_reasses_des\":{\"name\":\"Desired\",\"value\":\"\"}},{\"pain_reasses_unded\":{\"name\":\"Undesired\",\"value\":\"\"}},{\"pain_reasses_early\":{\"name\":\"Too early\",\"value\":\"\"}}],\"pain_reasses_comment\":\"\",\"procedure_name\":\"NC.NC.PRFPHRMM\",\"order_date_epic\":\"20150805103411\",\"order_date\":\"Aug 5, 2015\",\"order_time\":\"10:34 am\",\"accession_number\":\"T100027\",\"procedure\":\"procMPI\",\"procedure_type\":{\"name\":\"Adenosine\",\"value\":\"6\"},\"imaging_agent\":{\"name\":\"TC-99M Sestamibi\",\"value\":\"1\"},\"gbps_dose\":\"\",\"rest_dose\":\"20\",\"stress_dose\":\"\",\"rest_perf_dose\":\"\",\"fdg_dose\":\"\",\"insulin\":{\"name\":\"Insulin\",\"value\":\"\"},\"units\":\"\",\"max_dose\":{\"name\":\"140\",\"value\":\"140\"},\"max_dose_frac\":\"0.14\",\"time_max_dose_min\":\"5\",\"time_max_dose_sec\":\"43\",\"max_dose_min_dec\":\"5.72\",\"max_dose_calc\":\"61\",\"dob_cum_dose_calc\":\"0\",\"dipyridamole_dose_calc\":\"43\",\"atropine_dose\":\"\",\"iv_aminophylline\":\"\",\"procedural_comment\":\"\",\"restonly_hr\":\"\",\"restonly_bp_grid\":[{\"restonly_sbp\":\"\"},{\"restonly_dbp\":\"\"}],\"restonly_comment\":\"\",\"ecg_rhythm_grid\":[{\"ecg_nsr\":{\"name\":\"NSR\",\"value\":\"\"}},{\"ecg_ap\":{\"name\":\"A-Paced\",\"value\":\"\"}},{\"ecg_vp\":{\"name\":\"V-Paced\",\"value\":\"\"}},{\"ecg_avp\":{\"name\":\"AV-Paced\",\"value\":\"\"}},{\"ecg_apc\":{\"name\":\"APCs\",\"value\":\"\"}},{\"ecg_pvc\":{\"name\":\"PVCs\",\"value\":\"\"}},{\"ecg_afib\":{\"name\":\"AFib\",\"value\":\"\"}},{\"ecg_atfl\":{\"name\":\"Atrial Flutter\",\"value\":\"\"}},{\"ecg_svt\":{\"name\":\"SVT\",\"value\":\"\"}},{\"ecg_aivr\":{\"name\":\"AIVR\",\"value\":\"\"}},{\"ecg_ab\":{\"name\":\"Sinus Bradycardia\",\"value\":\"\"}},{\"ecg_1avb\":{\"name\":\"1degree AVB\",\"value\":\"\"}},{\"ecg_m1\":{\"name\":\"Mobitz I\",\"value\":\"\"}},{\"ecg_m2\":{\"name\":\"Mobitz II\",\"value\":\"\"}}],\"ecg_other_grid\":[{\"ecg_twnl\":{\"name\":\"TWNL\",\"value\":\"\"}},{\"ecg_imi\":{\"name\":\"IMI\",\"value\":\"\"}},{\"ecg_ami\":{\"name\":\"AMI\",\"value\":\"\"}},{\"ecg_tpmi\":{\"name\":\"TPMI\",\"value\":\"\"}},{\"ecg_latmi\":{\"name\":\"LatMI\",\"value\":\"\"}},{\"ecg_asmi\":{\"name\":\"ASMI\",\"value\":\"\"}},{\"ecg_ipmi\":{\"name\":\"IPMI\",\"value\":\"\"}},{\"ecg_lbbb\":{\"name\":\"LBBB\",\"value\":\"\"}},{\"ecg_rbbb\":{\"name\":\"RBBB\",\"value\":\"\"}},{\"ecg_ivcd\":{\"name\":\"IVCD\",\"value\":\"\"}},{\"ecg_lvh\":{\"name\":\"LVH\",\"value\":\"\"}},{\"ecg_rvh\":{\"name\":\"RVH\",\"value\":\"\"}},{\"ecg_bvh\":{\"name\":\"BVH\",\"value\":\"\"}},{\"ecg_lae\":{\"name\":\"LAE\",\"value\":\"\"}},{\"ecg_rae\":{\"name\":\"RAE\",\"value\":\"\"}},{\"ecg_bae\":{\"name\":\"BAE\",\"value\":\"\"}},{\"ecg_qwaves\":{\"name\":\"Q waves\",\"value\":\"\"}},{\"ecg_sttwa\":{\"name\":\"ST-T wave abnormalities\",\"value\":\"\"}},{\"ecg_prwp\":{\"name\":\"PRWP\",\"value\":\"\"}},{\"ecg_lph\":{\"name\":\"LPH\",\"value\":\"\"}},{\"ecg_lahb\":{\"name\":\"LAHB\",\"value\":\"\"}},{\"ecg_twi\":{\"name\":\"T wave inversions\",\"value\":\"\"}},{\"ecg_lad\":{\"name\":\"LAD\",\"value\":\"\"}},{\"ecg_rad\":{\"name\":\"RAD\",\"value\":\"\"}}],\"ecg_comments\":\"\",\"max_st_change_calc\":\"\",\"stress_ecg_comments\":\"\",\"arrhythmias\":{\"name\":\"No Arrhythmia\",\"value\":\"\"},\"arrhythmia_apc_occ\":{\"name\":\"Occasional\",\"value\":\"\"},\"arrhythmia_apc_frequent\":{\"name\":\"Frequent\",\"value\":\"\"},\"arrhythmia_vpc_occ\":{\"name\":\"Occasional\",\"value\":\"\"},\"arrhythmia_vpc_frequent\":{\"name\":\"Frequent\",\"value\":\"\"},\"arrhythmia_vt_sust\":{\"name\":\"Sustained (greater than 30 secs)\",\"value\":\"\"},\"arrhythmia_vt_non\":{\"name\":\"Non-sustained (less than 30 secs)\",\"value\":\"\"},\"arrhythmia_beats\":\"\",\"arrhythmia_rate\":\"\",\"arrhythmia_vea_coup\":{\"name\":\"Couplets\",\"value\":\"\"},\"arrhythmia_vea_bitri\":{\"name\":\"Bi/Tri Gemini\",\"value\":\"\"},\"resting_hr\":\"\",\"resting_bp_grid\":[{\"resting_sbp\":\"\"},{\"resting_dbp\":\"\"}],\"peak_hr\":\"\",\"peak_bp_grid\":[{\"peak_sbp\":\"\"},{\"peak_dbp\":\"\"}],\"min_bp_grid\":[{\"minimum_sbp\":\"\"},{\"minimum_dbp\":\"\"}],\"mphr\":\"0\",\"injection_time\":\"\",\"stress_chest_pain_composite\":[{\"cp_no\":{\"name\":\"Did not occur\",\"value\":\"\"}},{\"cp_yes\":{\"name\":\"Occurred\",\"value\":\"\"}},{\"cp_same\":{\"name\":\"Same as presenting pain\",\"value\":\"\"}},{\"cp_different\":{\"name\":\"Different from presenting pain\",\"value\":\"\"}},{\"cp_angina\":{\"name\":\"c/w angina\",\"value\":\"\"}},{\"cp_tng\":{\"name\":\"Required TNG\",\"value\":\"\"}},{\"cp_no_tng\":{\"name\":\"Did not require TNG\",\"value\":\"\"}}],\"angina_index\":\"0\",\"cp_onset_min\":\"\",\"cp_onset_sec\":\"\",\"cp_onset_hr\":\"\",\"cp_bp_grid\":[{\"cp_onset_sbp\":\"\"},{\"cp_onset_dbp\":\"\"}],\"peak_double\":\"0\",\"mets\":{\"name\":\"\",\"value\":\"\"},\"total_exercise_time_min\":\"\",\"total_exercise_time_sec\":\"\",\"total_exercise_time\":\"0\",\"treadmill_grade\":\"\",\"speed\":\"\",\"end_point_composite\":[{\"ep_arrhythmia\":{\"name\":\"Arrhythmia\",\"value\":\"\"}},{\"ep_chest_pain\":{\"name\":\"Chest pain\",\"value\":\"\"}},{\"ep_claudication\":{\"name\":\"Claudication\",\"value\":\"\"}},{\"ep_completed_protocol\":{\"name\":\"Completed protocol\",\"value\":\"\"}},{\"ep_dyspnea\":{\"name\":\"Dyspnea\",\"value\":\"\"}},{\"ep_fall_bp\":{\"name\":\"Fall in blood pressure\",\"value\":\"\"}},{\"ep_fatigue\":{\"name\":\"Fatigue\",\"value\":\"\"}},{\"ep_leg_fatigue\":{\"name\":\"Leg fatigue\",\"value\":\"\"}},{\"ep_lightheaded\":{\"name\":\"Lightheaded\",\"value\":\"\"}},{\"ep_refusal\":{\"name\":\"Refusal\",\"value\":\"\"}},{\"ep_st_elev\":{\"name\":\"ST elevation\",\"value\":\"\"}},{\"ep_st_dep\":{\"name\":\"ST depression\",\"value\":\"\"}},{\"ep_syncope\":{\"name\":\"Syncope\",\"value\":\"\"}},{\"ep_htn\":{\"name\":\"Hypertension\",\"value\":\"\"}},{\"ep_other\":{\"name\":\"Other\",\"value\":\"\"}},{\"ep_other_detail\":\"\"}],\"stress_data_comments\":\"\",\"procedural_notes\":\"\",\"include_report\":{\"name\":\"Include in report\",\"value\":\"\"},\"stress_conclusion_req_comment\":\"\",\"stress_conclusion_comment\":\"\",\"calc_duke\":{\"name\":\"\",\"value\":\"\"},\"duke_score\":\"0\",\"estimated_mortality\":\"1.4\",\"lv_ef\":\"\",\"ef_unobtain\":{\"name\":\"EF unobtainable (requires comment)\",\"value\":\"\"},\"lv_normal\":{\"name\":\"Rest LV size normal\",\"value\":\"\"},\"ef_unobtain_comment\":\"\",\"ef_comment\":\"\",\"lv_dilation_rest\":{\"name\":\"\",\"value\":\"\"},\"lv_dilation_stress\":{\"name\":\"\",\"value\":\"\"},\"rv_dilation\":{\"name\":\"\",\"value\":\"\"},\"extra_card\":{\"name\":\"\",\"value\":\"\"},\"imaging_comment\":\"\",\"lv_ef2\":\"\",\"ef_unobtain2\":{\"name\":\"EF unobtainable (requires comment)\",\"value\":\"\"},\"lv_normal2\":{\"name\":\"Rest LV size normal\",\"value\":\"\"},\"ef_unobtain_comment2\":\"\",\"ef_comment2\":\"\",\"non_cardiac_results\":{\"name\":\"\",\"value\":\"\"},\"non_cardiac_comment\":\"\",\"lv_dilation_rest2\":{\"name\":\"\",\"value\":\"\"},\"lv_dilation_stress2\":{\"name\":\"\",\"value\":\"\"},\"rv_dilation2\":{\"name\":\"\",\"value\":\"\"},\"extra_card2\":{\"name\":\"\",\"value\":\"\"},\"imaging_comment2\":\"\",\"all_wnl\":{\"name\":\"\",\"value\":\"\"},\"equivocal\":{\"name\":\"\",\"value\":\"\"},\"lvef\":\"\",\"ef_unobtain_gbps\":{\"name\":\"EF Unobtainable\",\"value\":\"\"},\"ra_wnl\":{\"name\":\"\",\"value\":\"\"},\"ra_grid\":[{\"ra_mild\":{\"name\":\"Enlarged mild\",\"value\":\"\"}},{\"ra_mod\":{\"name\":\"Enlarged moderate\",\"value\":\"\"}},{\"ra_sev\":{\"name\":\"Enlarged severe\",\"value\":\"\"}},{\"ra_akinetic\":{\"name\":\"Akinetic\",\"value\":\"\"}}],\"rv_wnl\":{\"name\":\"\",\"value\":\"\"},\"rv_grid\":[{\"rv_mild\":{\"name\":\"Enlarged mild\",\"value\":\"\"}},{\"rv_mod\":{\"name\":\"Enlarged moderate\",\"value\":\"\"}},{\"rv_sev\":{\"name\":\"Enlarged severe\",\"value\":\"\"}},{\"rv_asyn_ant\":{\"name\":\"Asynergy ant\",\"value\":\"\"}},{\"rv_asyn_inf\":{\"name\":\"Asynergy inf\",\"value\":\"\"}},{\"rv_asyn_sept\":{\"name\":\"Asynergy sept\",\"value\":\"\"}},{\"rv_asyn_lat\":{\"name\":\"Asynergy lat\",\"value\":\"\"}},{\"rv_asyn_glo\":{\"name\":\"Asynergy global\",\"value\":\"\"}}],\"pa_wnl\":{\"name\":\"\",\"value\":\"\"},\"pa_grid\":[{\"pa_mild\":{\"name\":\"Enlarged mild\",\"value\":\"\"}},{\"pa_mod\":{\"name\":\"Enlarged moderate\",\"value\":\"\"}},{\"pa_sev\":{\"name\":\"Enlarged severe\",\"value\":\"\"}}],\"la_wnl\":{\"name\":\"\",\"value\":\"\"},\"la_grid\":[{\"la_mild\":{\"name\":\"Enlarged mild\",\"value\":\"\"}},{\"la_mod\":{\"name\":\"Enlarged moderate\",\"value\":\"\"}},{\"la_sev\":{\"name\":\"Enlarged severe\",\"value\":\"\"}},{\"la_akinetic\":{\"name\":\"Akinetic\",\"value\":\"\"}}],\"lv_wnl\":{\"name\":\"\",\"value\":\"\"},\"lv_grid\":[{\"lv_mild\":{\"name\":\"Enlarged mild\",\"value\":\"\"}},{\"lv_mod\":{\"name\":\"Enlarged moderate\",\"value\":\"\"}},{\"lv_sev\":{\"name\":\"Enlarged severe\",\"value\":\"\"}},{\"lv_asyn_ant\":{\"name\":\"Asynergy ant\",\"value\":\"\"}},{\"lv_asyn_inf\":{\"name\":\"Asynergy inf\",\"value\":\"\"}},{\"lv_asyn_sept\":{\"name\":\"Asynergy sept\",\"value\":\"\"}},{\"lv_asyn_lat\":{\"name\":\"Asynergy lat\",\"value\":\"\"}},{\"lv_asyn_glo\":{\"name\":\"Asynergy global\",\"value\":\"\"}}],\"ao_wnl\":{\"name\":\"\",\"value\":\"\"},\"ao_grid\":[{\"ao_mild\":{\"name\":\"Enlarged mild\",\"value\":\"\"}},{\"ao_mod\":{\"name\":\"Enlarged moderate\",\"value\":\"\"}},{\"ao_sev\":{\"name\":\"Enlarged severe\",\"value\":\"\"}}],\"gbps_comment\":\"\",\"conclusion_template\":{\"name\":\"\",\"value\":\"\"},\"conc_ischem_size\":{\"name\":\"\",\"value\":\"\"},\"conc_ischem_change\":{\"name\":\"\",\"value\":\"\"},\"conc_ischem_zone\":{\"name\":\"\",\"value\":\"\"},\"conc_ischem_indicates\":{\"name\":\"\",\"value\":\"\"},\"conc_infarct_zone\":{\"name\":\"\",\"value\":\"\"},\"conc_infarct_prior\":{\"name\":\"\",\"value\":\"\"},\"conc_infarct_severity\":{\"name\":\"\",\"value\":\"\"},\"conc_same_comp\":\"\",\"conc_same_test\":{\"name\":\"\",\"value\":\"\"},\"conc_same_diff\":{\"name\":\"\",\"value\":\"\"},\"conc_worse_comp\":\"\",\"conc_worse_test\":{\"name\":\"\",\"value\":\"\"},\"conc_worse_zone\":{\"name\":\"\",\"value\":\"\"},\"conc_worse_diff\":{\"name\":\"\",\"value\":\"\"},\"conc_better_comp\":\"\",\"conc_better_test\":{\"name\":\"\",\"value\":\"\"},\"conc_better_zone\":{\"name\":\"\",\"value\":\"\"},\"conc_better_status\":{\"name\":\"\",\"value\":\"\"},\"conc_better_diff\":{\"name\":\"\",\"value\":\"\"},\"conc_mild_zone\":{\"name\":\"\",\"value\":\"\"},\"conc_further_comments\":\"\",\"event_date\":\"\",\"event_time\":\"\",\"critical_results_composite\":[{\"st_elevation\":{\"name\":\"ST elevation\",\"value\":\"\"}},{\"vt_vf\":{\"name\":\"VT/VF\",\"value\":\"\"}},{\"ant_ischemia_scan\":{\"name\":\"Anterior ischemia on scan; Suspect severe LAD or left main disease\",\"value\":\"\"}},{\"pos_ecg_scan\":{\"name\":\"Markedly positive ECG + scan ischemia\",\"value\":\"\"}},{\"pos_ecg_clinical\":{\"name\":\"Markedly positive ECG + clinical ischemia\",\"value\":\"\"}}],\"critical_result_comment\":\"\",\"md_name\":\"\",\"md_name2\":\"\",\"md_name3\":\"\",\"md_notified_date\":\"\",\"md_notified_time\":\"\",\"critical_result_notification_comment\":\"\",\"critical_result_verification\":{\"name\":\"The entire critical test result, including the patient's full name and medical record number, was read back by the receiving individual(s) and verified that the test result was correct.\",\"value\":\"\"},\"ready_for_review\":{\"name\":\"Technical portion completed. Ready for Reader review.\",\"value\":\"1\"},\"staff_card_signature_token\":\"eyJwcmluY2lwYWwiOiJhdDAxOCIsInRva2VuIjoiRkE2MzEyRDQtNEZEQy00ODBDLUI1RjYtNDJERUQ1MTU4REEwIiwiZGF0ZVRpbWUiOiIwMy8wMS8yMDE2IDI6MzcgUE0iLCJtYXNrIjo4fQ==\",\"staff_card_signature_uid\":\"at018\",\"staff_card_signature_dateTime\":\"03/01/2016 2:37 PM\",\"staff_rad_signature_token\":\"eyJwcmluY2lwYWwiOiJoZzAyNyIsInRva2VuIjoiRUNEMUQwNDUtNkQ3RC00RDZBLUE5NzUtRDMxQ0EyMEM5QTVBIiwiZGF0ZVRpbWUiOiIwMy8wMS8yMDE2IDI6MzcgUE0iLCJtYXNrIjo4fQ==\",\"staff_rad_signature_uid\":\"hg027\",\"staff_rad_signature_dateTime\":\"03/01/2016 2:37 PM\",\"narrative_placeholder\":\"\"}}";
			JsonNode jsonNode = new ObjectMapper().readValue(json, JsonNode.class);
//			Handlebars handlebars = new Handlebars();
			handlebars.registerHelper("json", Jackson2Helper.INSTANCE);
//			handlebars.registerHelpers("compare", inputStream);

			Context context = Context
					.newBuilder(jsonNode)
					.resolver(JsonNodeValueResolver.INSTANCE,
							JavaBeanValueResolver.INSTANCE,
							FieldValueResolver.INSTANCE,
							MapValueResolver.INSTANCE,
							MethodValueResolver.INSTANCE
					)
					.build();
			Template template2 = handlebars.compileInline(template.toString());
			System.out.println(template2.apply(context));




		} catch (IOException e) {
			e.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		}
	}


	// convert InputStream to String
	private static String getStringFromInputStream(InputStream is) {

		BufferedReader br = null;
		StringBuilder sb = new StringBuilder();

		String line;
		try {

			br = new BufferedReader(new InputStreamReader(is));
			while ((line = br.readLine()) != null) {
				sb.append(line);
			}

		} catch (IOException e) {
			e.printStackTrace();
		} finally {
			if (br != null) {
				try {
					br.close();
				} catch (IOException e) {
					e.printStackTrace();
				}
			}
		}

		return sb.toString();

	}
	private void init() {


		template.append("Purpose:     {{#if (or " +
				"            (eq sprout.userId \"5445476@mgh\") " +
				"            (eq sprout.userId \"5445478@mgh\") " +
				"            (eq sprout.userId \"5445471@mgh\") " +
				"            (eq sprout.userId \"5445477@mgh\") " +
				"          )" +
				"    }}" +
				"    This should appear if the locale is English OR Spanish!!!\n" +
				"    {{/if}}");
//		template.append("Purpose: {{#frm_nuclear_cardiolo_1.purpose_grid}}{{#each this}}{{#if this.value}}{{name}}; {{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.purpose_grid}}");


//		template.append("<!-- -------------- -->");
//		template.append("<!-- HEADING & DEMO -->");
//		template.append("<!-- -------------- -->");
//		template.append("");
//		template.append("<TABLE WIDTH=\"95%\">");
//		template.append("  <TR>");
//		template.append("    <TD VALIGN=\"top\">");
//		template.append("      <TABLE>");
//		template.append("        <TR>");
//		template.append("          <TD>");
//		template.append("            MASSACHUSETTS GENERAL HOSPITAL");
//		template.append("          </TD>");
//		template.append("        </TR>");
//		template.append("        <TR>");
//		template.append("          <TD>NUCLEAR CARDIOLOGY LABORATORY");
//		template.append("          </TD>");
//		template.append("        </TR>");
//		template.append("        <TR>");
//		template.append("          <TD>Test # {{frm_nuclear_cardiolo_1.order_no}} &nbsp;&nbsp;Care Facility: {{#getNode frm_nuclear_cardiolo_1.pt_location_grid 'lab'}}{{this.name}}{{/getNode}}");
//		template.append("          </TD>");
//		template.append("        </TR>");
//		template.append("        <TR>");
//		template.append("          <TD>");
//		template.append("            {{frm_nuclear_cardiolo_1.procedure_name}}");
//		template.append("          </TD>");
//		template.append("        </TR>");
//		template.append("      </TABLE>");
//		template.append("    </TD>");
//		template.append("    <TD VALIGN=\"top\" ALIGN=\"right\">");
//		template.append("      <TABLE>");
//		template.append("        <TR>");
//		template.append("          <TD NOWRAP=\"true\" VALIGN=\"top\">Unit #: <strong>{{frm_nuclear_cardiolo_1.mrn}}</strong>");
//		template.append("          </TD>");
//		template.append("          <TD NOWRAP=\"true\">Study Date: <strong>{{frm_nuclear_cardiolo_1.order_date}}</strong>");
//		template.append("          </TD>");
//		template.append("        </TR>");
//		template.append("        <TR>");
//		template.append("          <TD NOWRAP=\"true\">");
//		template.append("            <SPAN ALIGN=\"right\"><strong>{{#getNode frm_nuclear_cardiolo_1.pt_name_grid 'patient_last_name'}}{{this}}{{/getNode}}, {{#getNode frm_nuclear_cardiolo_1.pt_name_grid 'patent_first_name'}}{{this}}{{/getNode}} {{#getNode frm_nuclear_cardiolo_1.pt_name_grid 'patient_middle_initial'}}{{this}}{{/getNode}}</strong> &nbsp;</SPAN>");
//		template.append("          </TD>");
//		template.append("          <TD NOWRAP=\"true\" VALIGN=\"top\">DOB: {{frm_nuclear_cardiolo_1.dob}}");
//		template.append("          </TD>");
//		template.append("        </TR>");
//		template.append("        <TR>");
//		template.append("          <TD NOWRAP=\"true\" VALIGN=\"top\">Ht: {{frm_nuclear_cardiolo_1.height}} &nbsp;&nbsp;Wt: {{frm_nuclear_cardiolo_1.weight}} &nbsp;&nbsp;Sex: {{frm_nuclear_cardiolo_1.gender.value}} &nbsp;&nbsp;");
//		template.append("          </TD>");
//		template.append("          <TD NOWRAP=\"true\" VALIGN=\"top\">BMI: {{#if frm_nuclear_cardiolo_1.height}}{{#if frm_nuclear_cardiolo_1.weight}}{{frm_nuclear_cardiolo_1.bmi}}{{/if}}{{/if}} &nbsp;&nbsp;BSA: {{#if frm_nuclear_cardiolo_1.height}}{{#if frm_nuclear_cardiolo_1.weight}}{{frm_nuclear_cardiolo_1.bsa}}{{/if}}{{/if}}");
//		template.append("          </TD>");
//		template.append("        </TR>");
//		template.append("        <TR>");
//		template.append("          <TD COLSPAN=\"2\">Referring MD: {{frm_nuclear_cardiolo_1.ordering_md}}");
//		template.append("          </TD>");
//		template.append("        </TR>");
//		template.append("      </TABLE>");
//		template.append("    </TD>");
//		template.append("  </TR>");
//		template.append("</TABLE>");
//		template.append("");
//		template.append("");
//		template.append("</p>");
//		template.append("");
//		template.append("");
//		template.append("<!-- ------ -->");
//		template.append("<!-- STATUS -->");
//		template.append("<!-- ------ -->");
//		template.append("");
//		template.append("<br><hr style=\"display:none\">");
//		template.append("{{#if frm_nuclear_cardiolo_1.staff_card_signature_token}}");
//		template.append("    {{#compare frm_nuclear_cardiolo_1.procedure_code \"==\" \"STRESS100\"}}");
//		template.append("        <div align=\"center\"><strong>*** FINAL ***</strong></div>");
//		template.append("    {{else}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_code \"==\" \"STRESS102\"}}");
//		template.append("            <div align=\"center\"><strong>*** FINAL ***</strong></div>");
//		template.append("        {{else}}");
//		template.append("            {{#if frm_nuclear_cardiolo_1.staff_rad_signature_token}}");
//		template.append("                <div align=\"center\"><strong>*** FINAL ***</strong></div>");
//		template.append("            {{else}}");
//		template.append("                <div align=\"center\"><strong>*** Preliminary ***</strong></div>");
//		template.append("            {{/if}}");
//		template.append("        {{/compare}}");
//		template.append("    {{/compare}}");
//		template.append("{{else}}");
//		template.append("<div align=\"center\"><strong>*** Preliminary ***</strong></div>");
//		template.append("{{/if}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.aborted \"==\" \"52\"}}");
//		template.append("   <div align=\"center\"><strong>*** Aborted Study **</strong></div>");
//		template.append("{{/compare}}");
//		template.append("<br><hr style=\"display:none\">");
//		template.append("");
//		template.append("");
//		template.append("<!-- --------------------------------- -->");
//		template.append("<!-- PURPOSE, DIAGNOSIS, HISTORY, MEDS -->");
//		template.append("<!-- --------------------------------- -->");
//		template.append("");
//		template.append("<TABLE WIDTH=\"100%\">");
//		template.append("  <TR>");
//		template.append("    <TD><strong>Diagnosis:</strong> {{frm_nuclear_cardiolo_1.primary_dx.name}}{{#if frm_nuclear_cardiolo_1.secondary_dx.value}}; {{frm_nuclear_cardiolo_1.secondary_dx.name}}{{else}}{{/if}}{{#if frm_nuclear_cardiolo_1.other_dx}}; {{frm_nuclear_cardiolo_1.other_dx}}{{/if}}");
//		template.append("    </TD>");
//		template.append("    <TD></TD>");
//		template.append("  </TR>");
//		template.append("  <TR>");
//		template.append("    <TD style=\"width:65%;\" valign=\"top\"><strong>IHD Risks:</strong> {{#frm_nuclear_cardiolo_1.risk_factors_composite}}{{#each this}}{{#if this.value}}{{this.name}}; {{else}}{{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.risk_factors_composite}}<br>");
//		template.append("<strong>History:</strong> {{#frm_nuclear_cardiolo_1.history_composite}}{{#each this}}{{#if this.value}}{{this.name}}; {{else}}{{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.history_composite}}{{#frm_nuclear_cardiolo_1.history_composite}}{{#if hx_viagra_last_dose}}last dose: {{hx_viagra_last_dose}}{{else}}{{/if}}{{/frm_nuclear_cardiolo_1.history_composite}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.cath.value}}<br>{{else}}{{#if frm_nuclear_cardiolo_1.cabg.value}}<br>{{else}}{{#if frm_nuclear_cardiolo_1.ptca.value}}<br>{{/if}}{{/if}}{{/if}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.cabg.value}}");
//		template.append("    CABG {{#getNode frm_nuclear_cardiolo_1.cabg_composite 'cabg_date'}}{{this}}{{/getNode}} {{#frm_nuclear_cardiolo_1.cabg_composite}}{{#each this}}{{#if this.value}}{{this.name}} {{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.cabg_composite}} &nbsp;&nbsp;&nbsp;");
//		template.append("{{/if}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.ptca.value}}");
//		template.append("    PTCAStents {{#getNode frm_nuclear_cardiolo_1.ptca_composite 'ptca_date'}}{{this}}{{/getNode}} {{#frm_nuclear_cardiolo_1.ptca_composite}}{{#each this}}{{#if this.value}}{{this.name}} {{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.ptca_composite}} &nbsp;&nbsp;&nbsp;");
//		template.append("{{/if}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.cath.value}}");
//		template.append("    Cath {{#getNode frm_nuclear_cardiolo_1.cath_composite 'cath_date'}}{{this}}{{/getNode}} {{#frm_nuclear_cardiolo_1.cath_composite}}{{#each this}}{{#if this.value}}{{this.name}} {{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.cath_composite}}");
//		template.append("{{/if}}");
//		template.append("    </TD>");



//		template.append("    <TD VALIGN=\"top\"><strong>Purpose:</strong> {{#frm_nuclear_cardiolo_1.purpose_grid}}{{#each this}}{{#if this.value}}{{this.name}}; {{/if}}{{/each}}");
//		template.append("      {{/frm_nuclear_cardiolo_1.purpose_grid}}<br>");
//		template.append("<strong>Medications: </strong>{{#compare frm_nuclear_cardiolo_1.medications.value \"==\" \"1\"}}{{frm_nuclear_cardiolo_1.min_medication_name}}; {{#frm_nuclear_cardiolo_1.medications_table}}{{medication_name}}; {{/frm_nuclear_cardiolo_1.medications_table}}{{frm_nuclear_cardiolo_1.medications_other}}{{else}}None{{/compare}}");
//		template.append("    </TD>");



//		template.append("  </TR>");
//		template.append("</TABLE>");
//		template.append("</p>");
//		template.append("<br>");
//		template.append("");
//		template.append("<!-- -------------- -->");
//		template.append("<!-- PAIN SCREENING -->");
//		template.append("<!-- -------------- -->");
//		template.append("");
//		template.append("<strong>Pain Screening:</strong>");
//		template.append("{{#if frm_nuclear_cardiolo_1.pain_scale_in.value}} &nbsp;&nbsp;<strong>Inpatient:</strong> {{frm_nuclear_cardiolo_1.pain_scale_in.value}} &nbsp;&nbsp;{{#if frm_nuclear_cardiolo_1.pain_in_other}}{{frm_nuclear_cardiolo_1.pain_in_other}} &nbsp;&nbsp;{{/if}}{{/if}}{{#if frm_nuclear_cardiolo_1.chest_pain.value}}<strong>Outpatient:</strong> {{#compare frm_nuclear_cardiolo_1.chest_pain.value \"==\" \"0\"}}No CP. {{/compare}}{{#compare frm_nuclear_cardiolo_1.chest_pain.value \"==\" \"1\"}}CP. {{/compare}}{{#compare frm_nuclear_cardiolo_1.limiting_chest_pain.value \"==\" \"0\"}}Test not prevented by pain. {{/compare}}{{#compare frm_nuclear_cardiolo_1.limiting_chest_pain.value \"==\" \"1\"}}Pain prevents test. {{/compare}}{{/if}}<br>");
//		template.append("{{#getNode frm_nuclear_cardiolo_1.pain_refer_composite 'pain_to_note'}}");
//		template.append("    {{#if this.value}}");
//		template.append("        {{#../../frm_nuclear_cardiolo_1.pain_refer_composite}}{{#each this}}{{#if this.value}}Refer to <font style=\"text-transform: lowercase;\">{{this.name}}</font>. {{/if}}{{/each}}{{/../../frm_nuclear_cardiolo_1.pain_refer_composite}}<br>");
//		template.append("    {{else}}");
//		template.append("        {{#getNode ../../frm_nuclear_cardiolo_1.pain_refer_composite 'pain_to_chart'}}");
//		template.append("            {{#if this.value}}");
//		template.append("                {{#../../../../frm_nuclear_cardiolo_1.pain_refer_composite}}{{#each this}}{{#if this.value}}Refer to <font style=\"text-transform: lowercase;\">{{this.name}}</font>. {{/if}}{{/each}}{{/../../../../frm_nuclear_cardiolo_1.pain_refer_composite}}<br>");
//		template.append("            {{else}}");
//		template.append("                {{#getNode ../../../../frm_nuclear_cardiolo_1.pain_refer_composite 'pain_to_flow'}}");
//		template.append("                    {{#if this.value}}");
//		template.append("                        {{#../../../../../../frm_nuclear_cardiolo_1.pain_refer_composite}}{{#each this}}{{#if this.value}}Refer to <font style=\"text-transform: lowercase;\">{{this.name}}</font>. {{/if}}{{/each}}{{/../../../../../../frm_nuclear_cardiolo_1.pain_refer_composite}}<br>");
//		template.append("                    {{/if}}");
//		template.append("                {{/getNode}}");
//		template.append("            {{/if}}");
//		template.append("        {{/getNode}}");
//		template.append("    {{/if}}");
//		template.append("{{/getNode}}");
//		template.append("<strong>Pain Assessment:</strong> Performed by: {{frm_nuclear_cardiolo_1.pain_perf_by}} &nbsp;&nbsp;Location: {{frm_nuclear_cardiolo_1.pain_location.name}} &nbsp;&nbsp;Intensity: {{frm_nuclear_cardiolo_1.pain_scale.name}}<br>");
//		template.append("{{#if frm_nuclear_cardiolo_1.pain_comment}}Comments: {{frm_nuclear_cardiolo_1.pain_comment}}<br> {{/if}}");
//		template.append("<strong>Treatment:</strong>");
//		template.append("{{#frm_nuclear_cardiolo_1.pain_ref_composite}}");
//		template.append("    {{#each this}}{{#if this.value}}Refer to {{this.name}}. {{/if}}{{/each}}");
//		template.append("{{/frm_nuclear_cardiolo_1.pain_ref_composite}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.pain_meds.value}}{{frm_nuclear_cardiolo_1.pain_meds.name}}. {{/if}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.pain_treat_other}}Other treatment: {{frm_nuclear_cardiolo_1.pain_treat_other}}{{/if}}");
//		template.append("<br>");
//		template.append("<strong>Pain Re-Assessment:</strong>");
//		template.append("{{#frm_nuclear_cardiolo_1.pain_reasses_composite}}");
//		template.append("    {{#each this}}{{#if this.value}}{{this.name}} &nbsp;&nbsp;{{/if}}{{/each}}");
//		template.append("{{/frm_nuclear_cardiolo_1.pain_reasses_composite}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.pain_reasses_comment}}Comments: {{frm_nuclear_cardiolo_1.pain_reasses_comment}}{{/if}}");
//		template.append("</p>");
//		template.append("<br>");
//		template.append("");
//		template.append("<!-- --------------- -->");
//		template.append("<!-- NIETT PROCEDURE -->");
//		template.append("<!-- --------------- -->");
//		template.append("");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure \"==\" \"procNIETT\"}}<hr style=\"display:none\"><strong>Protocol</strong></p>");
//		template.append("<div style=\"margin-left: 2em;\">The patient underwent a treadmill stress test using {{#compare frm_nuclear_cardiolo_1.procedure \"==\" \"procNIETT\"}}{{#compare frm_nuclear_cardiolo_1.procedure_type.value \"!==\" \"5\"}}the {{frm_nuclear_cardiolo_1.procedure_type.name}}{{/compare}}{{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"5\"}}a special{{/compare}} protocol.");
//		template.append("{{#if frm_nuclear_cardiolo_1.procedural_comment}}</p><strong>Comment:</strong> {{frm_nuclear_cardiolo_1.procedural_comment}}{{/if}}");
//		template.append("</div>");
//		template.append("</p>{{/compare}}{{/compare}}");
//		template.append("");
//		template.append("<!-- ----------------- -->");
//		template.append("<!-- REST HEMODYNAMICS -->");
//		template.append("<!-- ----------------- -->");
//		template.append("");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure \"!==\" \"\"}}{{#compare frm_nuclear_cardiolo_1.procedure \"==\" \"procMPI\"}}{{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"1\"}}<hr style=\"display:none\">");
//		template.append("<strong>Rest Hemodynamics</strong><br>");
//		template.append("<div style=\"margin-left: 2em;\">");
//		template.append("Resting HR: {{frm_nuclear_cardiolo_1.restonly_hr}}<br>");
//		template.append("Resting BP: {{#frm_nuclear_cardiolo_1.restonly_bp_grid}}{{restonly_sbp}}{{/frm_nuclear_cardiolo_1.restonly_bp_grid}}/{{#frm_nuclear_cardiolo_1.restonly_bp_grid}}{{restonly_dbp}}{{/frm_nuclear_cardiolo_1.restonly_bp_grid}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.restonly_comment}}<br>Comment: {{frm_nuclear_cardiolo_1.restonly_comment}}{{/if}}");
//		template.append("</div>");
//		template.append("</p>");
//		template.append("{{/compare}}{{/compare}}{{/compare}}");
//		template.append("");
//		template.append("<!-- ------------------- -->");
//		template.append("<!-- STRESS TEST RESULTS -->");
//		template.append("<!-- ------------------- -->");
//		template.append("");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure \"!==\" \"\"}}{{#compare frm_nuclear_cardiolo_1.procedure \"!==\" \"procGBPS\"}}{{#compare frm_nuclear_cardiolo_1.procedure \"!==\" \"procPETMV\"}}{{#compare frm_nuclear_cardiolo_1.procedure_type.value \"!==\" \"1\"}}<hr style=\"display:none\">");
//		template.append("<strong>Stress Test Results</strong> &nbsp;&nbsp;&nbsp;&nbsp;Type: {{frm_nuclear_cardiolo_1.procedure_type.name}}</p>");
//		template.append("<div style=\"margin-left: 2em;\"><strong>Total Exercise Time:</strong> {{frm_nuclear_cardiolo_1.total_exercise_time_min}} min {{frm_nuclear_cardiolo_1.total_exercise_time_sec}} sec &nbsp;&nbsp;&nbsp;&nbsp;<strong>METS:</strong> {{frm_nuclear_cardiolo_1.mets.name}} &nbsp;&nbsp;&nbsp;&nbsp;<strong>Treadmill Grade:</strong> {{frm_nuclear_cardiolo_1.treadmill_grade}}% &nbsp;&nbsp;&nbsp;&nbsp;<strong>Speed:</strong> {{frm_nuclear_cardiolo_1.speed}} mph</p>");
//		template.append("<TABLE>");
//		template.append("    <TR>");
//		template.append("        <TH></TH>");
//		template.append("        <TH VALIGN=\"top\" ALIGN=\"left\"><strong>Rest &nbsp;&nbsp;&nbsp;&nbsp;</strong></TH>");
//		template.append("        <TH VALIGN=\"top\" ALIGN=\"left\"><strong>Max &nbsp;&nbsp;&nbsp;&nbsp;</strong></TH>");
//		template.append("        {{#frm_nuclear_cardiolo_1.min_bp_grid}}{{#if minimum_sbp}}<TH VALIGN=\"top\" ALIGN=\"left\"><strong>Min &nbsp;&nbsp;</strong></TH>{{/if}}{{/frm_nuclear_cardiolo_1.min_bp_grid}}");
//		template.append("        <TH> &nbsp;&nbsp;&nbsp;&nbsp;</TH>");
//		template.append("   </TR>");
//		template.append("    <TR>");
//		template.append("        <TD><strong>HR</strong> (bpm) &nbsp;&nbsp;&nbsp;&nbsp;</TD>");
//		template.append("        <TD VALIGN=\"top\">{{frm_nuclear_cardiolo_1.resting_hr}} &nbsp;&nbsp;&nbsp;&nbsp;</TD>");
//		template.append("        <TD VALIGN=\"top\">{{frm_nuclear_cardiolo_1.peak_hr}} ({{frm_nuclear_cardiolo_1.mphr}}% max predicted) &nbsp;&nbsp;&nbsp;&nbsp;</TD>");
//		template.append("        {{#frm_nuclear_cardiolo_1.min_bp_grid}}{{#if minimum_sbp}}<TD></TD>{{/if}}{{/frm_nuclear_cardiolo_1.min_bp_grid}}");
//		template.append("        <TD></TD>");
//		template.append("    </TR>");
//		template.append("    <TR>");
//		template.append("        <TD VALIGN=\"top\"><strong>BP</strong> (mmHg) &nbsp;&nbsp;&nbsp;&nbsp;</TD>");
//		template.append("        <TD VALIGN=\"top\">{{#frm_nuclear_cardiolo_1.resting_bp_grid}}{{resting_sbp}}{{/frm_nuclear_cardiolo_1.resting_bp_grid}}/{{#frm_nuclear_cardiolo_1.resting_bp_grid}}{{resting_dbp}}{{/frm_nuclear_cardiolo_1.resting_bp_grid}}</TD>");
//		template.append("        <TD VALIGN=\"top\">{{#frm_nuclear_cardiolo_1.peak_bp_grid}}{{peak_sbp}}{{/frm_nuclear_cardiolo_1.peak_bp_grid}}/{{#frm_nuclear_cardiolo_1.peak_bp_grid}}{{peak_dbp}}{{/frm_nuclear_cardiolo_1.peak_bp_grid}} &nbsp;&nbsp;&nbsp;&nbsp;</TD>");
//		template.append("        {{#frm_nuclear_cardiolo_1.min_bp_grid}}{{#if minimum_sbp}}<TD VALIGN=\"top\">{{#../../frm_nuclear_cardiolo_1.min_bp_grid}}{{minimum_sbp}}{{/../../frm_nuclear_cardiolo_1.min_bp_grid}}/{{#../../frm_nuclear_cardiolo_1.min_bp_grid}}{{minimum_dbp}}{{/../../frm_nuclear_cardiolo_1.min_bp_grid}} &nbsp;&nbsp;&nbsp;&nbsp;</TD>{{/if}}{{/frm_nuclear_cardiolo_1.min_bp_grid}}");
//		template.append("        <TD VALIGN=\"top\"><strong>Peak Double Product:</strong> {{frm_nuclear_cardiolo_1.peak_double}} mmHg/min </TD>");
//		template.append("    </TR>");
//		template.append("</TABLE>");
//		template.append("<TABLE WIDTH = \"100%\">");
//		template.append("    <TR>");
//		template.append("        <TD VALIGN=\"top\" WIDTH=\"50%\"><strong>Chest pain:</strong> {{#frm_nuclear_cardiolo_1.stress_chest_pain_composite}}{{#each this}}{{#if this.value}}{{this.name}}; {{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.stress_chest_pain_composite}} &nbsp;&nbsp;</TD>");
//		template.append("        <TD VALIGN=\"top\"><strong>Endpoint:</strong>");
//		template.append("{{#frm_nuclear_cardiolo_1.end_point_composite}}{{#each this}}{{#if this.value}}{{this.name}}; {{else}}{{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.end_point_composite}}{{#frm_nuclear_cardiolo_1.end_point_composite}}{{#if ep_other_detail}}{{ep_other_detail}}{{else}}{{/if}}{{/frm_nuclear_cardiolo_1.end_point_composite}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.ep_other.value \"==\" \"1\"}} {{frm_nuclear_cardiolo_1.ep_other_detail}};{{/compare}}</TD>");
//		template.append("    </TR>");
//		template.append("</TABLE>");
//		template.append("{{#if frm_nuclear_cardiolo_1.cp_onset_hr}}");
//		template.append("</p>");
//		template.append("<strong>At Onset Chest Pain: </strong>");
//		template.append("{{#frm_nuclear_cardiolo_1.cp_bp_grid}}{{#if cp_onset_sbp}} &nbsp;&nbsp;&nbsp;BP: {{#../../frm_nuclear_cardiolo_1.cp_bp_grid}}{{cp_onset_sbp}}{{/../../frm_nuclear_cardiolo_1.cp_bp_grid}}/{{#../../frm_nuclear_cardiolo_1.cp_bp_grid}}{{cp_onset_dbp}}{{/../../frm_nuclear_cardiolo_1.cp_bp_grid}} mmHg{{/if}}{{/frm_nuclear_cardiolo_1.cp_bp_grid}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.cp_onset_hr}} &nbsp;&nbsp;&nbsp;HR: {{frm_nuclear_cardiolo_1.cp_onset_hr}} bpm{{else}}{{/if}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.cp_onset_min}} &nbsp;&nbsp;&nbsp;Pain began at {{frm_nuclear_cardiolo_1.cp_onset_min}} min{{#if frm_nuclear_cardiolo_1.cp_onset_sec}} {{frm_nuclear_cardiolo_1.cp_onset_sec}} sec{{else}}{{/if}}{{#if frm_nuclear_cardiolo_1.cp_setting}} of <font style=\"text-transform: lowercase;\">{{frm_nuclear_cardiolo_1.cp_setting.name}}</font>.{{/if}}{{else}}{{#if frm_nuclear_cardiolo_1.cp_setting}} &nbsp;&nbsp;&nbsp;Pain began at <font style=\"text-transform: lowercase;\">{{frm_nuclear_cardiolo_1.cp_setting.name}}</font>.{{/if}}{{/if}}");
//		template.append("{{else}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.cp_setting.value}}");
//		template.append("</p>");
//		template.append("<strong>At Onset Chest Pain: </strong>");
//		template.append("{{#frm_nuclear_cardiolo_1.cp_bp_grid}}{{#if cp_onset_sbp}} &nbsp;&nbsp;&nbsp;BP: {{#../../frm_nuclear_cardiolo_1.cp_bp_grid}}{{cp_onset_sbp}}{{/../../frm_nuclear_cardiolo_1.cp_bp_grid}}/{{#../../frm_nuclear_cardiolo_1.cp_bp_grid}}{{cp_onset_dbp}}{{/../../frm_nuclear_cardiolo_1.cp_bp_grid}} mmHg{{/if}}{{/frm_nuclear_cardiolo_1.cp_bp_grid}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.cp_onset_hr}} &nbsp;&nbsp;&nbsp;HR: {{frm_nuclear_cardiolo_1.cp_onset_hr}} bpm{{else}}{{/if}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.cp_onset_min}} &nbsp;&nbsp;&nbsp;Pain began at {{frm_nuclear_cardiolo_1.cp_onset_min}} min{{#if frm_nuclear_cardiolo_1.cp_onset_sec}} {{frm_nuclear_cardiolo_1.cp_onset_sec}} sec{{else}}{{/if}}{{#if frm_nuclear_cardiolo_1.cp_setting}} of <font style=\"text-transform: lowercase;\">{{frm_nuclear_cardiolo_1.cp_setting.name}}</font>.{{/if}}{{else}}{{#if frm_nuclear_cardiolo_1.cp_setting}} &nbsp;&nbsp;&nbsp;Pain began at <font style=\"text-transform: lowercase;\">{{frm_nuclear_cardiolo_1.cp_setting.name}}</font>.{{/if}}{{/if}}");
//		template.append("{{else}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.cp_onset_min}}");
//		template.append("</p>");
//		template.append("<strong>At Onset Chest Pain: </strong>");
//		template.append("{{#frm_nuclear_cardiolo_1.cp_bp_grid}}{{#if cp_onset_sbp}} &nbsp;&nbsp;&nbsp;BP: {{#../../frm_nuclear_cardiolo_1.cp_bp_grid}}{{cp_onset_sbp}}{{/../../frm_nuclear_cardiolo_1.cp_bp_grid}}/{{#../../frm_nuclear_cardiolo_1.cp_bp_grid}}{{cp_onset_dbp}}{{/../../frm_nuclear_cardiolo_1.cp_bp_grid}} mmHg{{/if}}{{/frm_nuclear_cardiolo_1.cp_bp_grid}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.cp_onset_hr}} &nbsp;&nbsp;&nbsp;HR: {{frm_nuclear_cardiolo_1.cp_onset_hr}} bpm{{else}}{{/if}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.cp_onset_min}} &nbsp;&nbsp;&nbsp;Pain began at {{frm_nuclear_cardiolo_1.cp_onset_min}} min{{#if frm_nuclear_cardiolo_1.cp_onset_sec}} {{frm_nuclear_cardiolo_1.cp_onset_sec}} sec{{else}}{{/if}}{{#if frm_nuclear_cardiolo_1.cp_setting}} of <font style=\"text-transform: lowercase;\">{{frm_nuclear_cardiolo_1.cp_setting.name}}</font>.{{/if}}{{else}}{{#if frm_nuclear_cardiolo_1.cp_setting}} &nbsp;&nbsp;&nbsp;Pain began at <font style=\"text-transform: lowercase;\">{{frm_nuclear_cardiolo_1.cp_setting.name}}</font>.{{/if}}{{/if}}");
//		template.append("{{/if}}");
//		template.append("{{/if}}");
//		template.append("{{/if}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.include_report.value \"==\" \"1\"}}</p><strong>Procedural Notes:</strong>");
//		template.append("{{frm_nuclear_cardiolo_1.procedural_notes}}");
//		template.append("</p>{{/compare}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.stress_data_comments}}</p><strong>Comments:</strong> {{frm_nuclear_cardiolo_1.stress_data_comments}}{{else}}{{/if}}");
//		template.append("</p><strong>Test supervised by:</strong> {{frm_nuclear_cardiolo_1.rendering_provider}}{{#if frm_nuclear_cardiolo_1.billing_provider}}; {{frm_nuclear_cardiolo_1.billing_provider}} {{/if}}");
//		template.append("</div>");
//		template.append("</p>");
//		template.append("{{/compare}}{{/compare}}{{/compare}}{{/compare}}");
//		template.append("");
//		template.append("<!-- ----------- -->");
//		template.append("<!-- ECG RESULTS -->");
//		template.append("<!-- ----------- -->");
//		template.append("");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure \"==\" \"procMPI\"}}{{#compare frm_nuclear_cardiolo_1.procedure_type.value \"!==\" \"1\"}}<hr style=\"display:none\">");
//		template.append("<strong>ECG</strong>");
//		template.append("<br>");
//		template.append("<div style=\"margin-left: 2em;\">");
//		template.append("<strong>Baseline:</strong> {{#frm_nuclear_cardiolo_1.ecg_rhythm_grid}}{{#each this}}{{#if this.value}}{{this.name}}; &nbsp;{{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.ecg_rhythm_grid}}{{#frm_nuclear_cardiolo_1.ecg_other_grid}}{{#each this}}{{#if this.value}}{{this.name}}; &nbsp;{{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.ecg_other_grid}}{{#if frm_nuclear_cardiolo_1.ecg_comments}}{{frm_nuclear_cardiolo_1.ecg_comments}} &nbsp;{{/if}}<br>");
//		template.append("<TABLE WIDTH=\"100%\">");
//		template.append("  <TR>");
//		template.append("    <TD VALIGN=\"top\">");
//		template.append("        <strong>Stress:</strong> {{frm_nuclear_cardiolo_1.stress_ecg.name}}<br>");
//		template.append("              <TABLE BORDER=\"0\" CELLSPACING=\"0\">");
//		template.append("                {{#if frm_nuclear_cardiolo_1.stress_ecg_table}}");
//		template.append("                <TR>");
//		template.append("                    <TH> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TH>");
//		template.append("                    <TH ALIGN=\"left\"><strong>ST Change &nbsp;</strong></TH>");
//		template.append("                    <TH ALIGN=\"left\"><strong>Contour</strong> &nbsp;</TH>");
//		template.append("                    <TH ALIGN=\"left\"><strong>Elev/Dep</strong> &nbsp;</TH>");
//		template.append("                </TR>");
//		template.append("                {{/if}}");
//		template.append("                {{#each frm_nuclear_cardiolo_1.stress_ecg_table}}");
//		template.append("                <TR>");
//		template.append("                    <TD ALIGN=\"right\">{{stress_name.name}} &nbsp;</TD>");
//		template.append("                    <TD>{{st_change}} &nbsp;</TD>");
//		template.append("                    <TD>{{contour.name}} &nbsp;</TD>");
//		template.append("                    <TD>{{elev_dep.name}} &nbsp;</TD>");
//		template.append("                </TR>{{/each}}");
//		template.append("        </TABLE>");
//		template.append("    </TD>");
//		template.append("    <TD VALIGN=\"top\">");
//		template.append("      <TABLE BORDER=\"0\" CELLSPACING=\"0\">");
//		template.append("        <TR>");
//		template.append("            <TD align=\"left\" valign=\"top\"><strong>Arrhythmias:</strong>&nbsp;{{#if frm_nuclear_cardiolo_1.arrhythmias.value}}None{{/if}}</TD>");
//		template.append("            <td></td>");
//		template.append("        </TR>");
//		template.append("        <TR>");
//		template.append("            {{#if frm_nuclear_cardiolo_1.arrhythmia_apc_occ.value}}<td>APC: {{frm_nuclear_cardiolo_1.arrhythmia_apc_occ.name}} &nbsp;</td>{{/if}}");
//		template.append("            {{#if frm_nuclear_cardiolo_1.arrhythmia_apc_frequent.value}}<td>APC: {{frm_nuclear_cardiolo_1.arrhythmia_apc_frequent.name}} &nbsp;</td>{{/if}}");
//		template.append("");
//		template.append("          {{#if frm_nuclear_cardiolo_1.arrhythmia_vpc_occ.value}}<td>VPC: {{frm_nuclear_cardiolo_1.arrhythmia_vpc_occ.name}} &nbsp;</td>{{/if}}");
//		template.append("            {{#if frm_nuclear_cardiolo_1.arrhythmia_vpc_frequent.value}}<td>VPC: {{frm_nuclear_cardiolo_1.arrhythmia_vpc_frequent.name}} &nbsp;</td>{{/if}}");
//		template.append("        </TR>");
//		template.append("        <TR>");
//		template.append("          {{#if frm_nuclear_cardiolo_1.arrhythmia_vt_sust.value}}<td>VT: Sustained (&gt;30 secs) &nbsp;</td>{{/if}}");
//		template.append("          {{#if frm_nuclear_cardiolo_1.arrhythmia_vt_non.value}}<td>VT: Nonustained (&lt;30 secs) &nbsp;</td>{{/if}}");
//		template.append("          {{#if frm_nuclear_cardiolo_1.arrhythmia_vea_coup.value}}<td>Complex VEA: {{frm_nuclear_cardiolo_1.arrhythmia_vea_coup.name}}{{#if frm_nuclear_cardiolo_1.arrhythmia_vea_bitri.value}}; {{frm_nuclear_cardiolo_1.arrhythmia_vea_bitri.name}}{{/if}}</td>{{else}}{{#if frm_nuclear_cardiolo_1.arrhythmia_vea_bitri.value}}<td>Complex VEA: {{frm_nuclear_cardiolo_1.arrhythmia_vea_bitri.name}}</td>{{/if}}{{/if}}");
//		template.append("        </TR>");
//		template.append("        <TR>");
//		template.append("          {{#if frm_nuclear_cardiolo_1.arrhythmia_rate}}<TD>Rate: {{frm_nuclear_cardiolo_1.arrhythmia_rate}}</TD>{{/if}}");
//		template.append("          {{#if frm_nuclear_cardiolo_1.arrhythmia_beats}}<TD>Beats: {{frm_nuclear_cardiolo_1.arrhythmia_beats}}</TD>{{/if}}");
//		template.append("        </TR>");
//		template.append("      </TABLE>");
//		template.append("    </TD>");
//		template.append("  </TR>");
//		template.append("  <tr>");
//		template.append("      <td colspan=\"2\"></td>");
//		template.append("  </tr>");
//		template.append("</TABLE>");
//		template.append("  {{#if frm_nuclear_cardiolo_1.stress_ecg_comments}}");
//		template.append("<strong>Comment:</strong> {{frm_nuclear_cardiolo_1.stress_ecg_comments}}");
//		template.append("  {{/if}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.calc_duke.value}}{{#compare frm_nuclear_cardiolo_1.calc_duke.value \"!==\" \"0\"}}{{#if frm_nuclear_cardiolo_1.duke_score}}");
//		template.append("</p>");
//		template.append("<strong>Duke ETT Score:</strong> {{frm_nuclear_cardiolo_1.duke_score}} &nbsp;&nbsp;&nbsp;&nbsp;Annual Cardiovascular Mortality Estimated from Duke Score: {{frm_nuclear_cardiolo_1.estimated_mortality}}<br>");
//		template.append("<div style=\"margin-left: 2em; font-size: 9pt;\">Risk status based on AHCPR Publication No. 94-0603 May 1994:<br>");
//		template.append("Low = Annual Mortality < 1%&nbsp;&nbsp;&nbsp;&nbsp;Intermediate = Annual Mortality 2 - 3%&nbsp;&nbsp;&nbsp;&nbsp;High = Annual Mortality 4%");
//		template.append("{{/if}}{{/compare}}{{/if}}");
//		template.append("</div>");
//		template.append("</div>");
//		template.append("</p>");
//		template.append("{{/compare}}");
//		template.append("{{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure \"==\" \"procNIETT\"}}<hr style=\"display:none\">");
//		template.append("<strong>ECG</strong>");
//		template.append("<br>");
//		template.append("<div style=\"margin-left: 2em;\">");
//		template.append("<strong>Baseline:</strong> {{#frm_nuclear_cardiolo_1.ecg_rhythm_grid}}{{#each this}}{{#if this.value}}{{this.name}}; &nbsp;{{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.ecg_rhythm_grid}}{{#frm_nuclear_cardiolo_1.ecg_other_grid}}{{#each this}}{{#if this.value}}{{this.name}}; &nbsp;{{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.ecg_other_grid}}{{#if frm_nuclear_cardiolo_1.ecg_comments}}{{frm_nuclear_cardiolo_1.ecg_comments}} &nbsp;{{/if}}<br>");
//		template.append("<TABLE WIDTH=\"100%\">");
//		template.append("  <TR>");
//		template.append("    <TD VALIGN=\"top\">");
//		template.append("        <strong>Stress:</strong> {{frm_nuclear_cardiolo_1.stress_ecg.name}}<br>");
//		template.append("              <TABLE BORDER=\"0\" CELLSPACING=\"0\">");
//		template.append("                {{#if frm_nuclear_cardiolo_1.stress_ecg_table}}");
//		template.append("                <TR>");
//		template.append("                    <TH> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TH>");
//		template.append("                    <TH><strong>ST Change &nbsp;</strong></TH>");
//		template.append("                    <TH><strong>Contour</strong> &nbsp;</TH>");
//		template.append("                    <TH><strong>Elev/Dep</strong> &nbsp;</TH>");
//		template.append("                </TR>");
//		template.append("                {{/if}}");
//		template.append("                {{#each frm_nuclear_cardiolo_1.stress_ecg_table}}");
//		template.append("                <TR>");
//		template.append("                    <TD ALIGN=\"right\">{{stress_name.name}} &nbsp;</TD>");
//		template.append("                    <TD>{{st_change}} &nbsp;</TD>");
//		template.append("                    <TD>{{contour.name}} &nbsp;</TD>");
//		template.append("                    <TD>{{elev_dep.name}} &nbsp;</TD>");
//		template.append("                </TR>{{/each}}");
//		template.append("        </TABLE>");
//		template.append("    </TD>");
//		template.append("    <TD VALIGN=\"top\">");
//		template.append("      <TABLE BORDER=\"0\" CELLSPACING=\"0\">");
//		template.append("        <TR>");
//		template.append("            <TD align=\"left\" valign=\"top\"><strong>Arrhythmias:</strong>&nbsp;{{#if frm_nuclear_cardiolo_1.arrhythmias.value}}None{{/if}}</TD>");
//		template.append("            <td></td>");
//		template.append("        </TR>");
//		template.append("        <TR>");
//		template.append("            {{#if frm_nuclear_cardiolo_1.arrhythmia_apc_occ.value}}<td>APC: {{frm_nuclear_cardiolo_1.arrhythmia_apc_occ.name}} &nbsp;</td>{{/if}}");
//		template.append("            {{#if frm_nuclear_cardiolo_1.arrhythmia_apc_frequent.value}}<td>APC: {{frm_nuclear_cardiolo_1.arrhythmia_apc_frequent.name}} &nbsp;</td>{{/if}}");
//		template.append("");
//		template.append("          {{#if frm_nuclear_cardiolo_1.arrhythmia_vpc_occ.value}}<td>VPC: {{frm_nuclear_cardiolo_1.arrhythmia_vpc_occ.name}} &nbsp;</td>{{/if}}");
//		template.append("            {{#if frm_nuclear_cardiolo_1.arrhythmia_vpc_frequent.value}}<td>VPC: {{frm_nuclear_cardiolo_1.arrhythmia_vpc_frequent.name}} &nbsp;</td>{{/if}}");
//		template.append("        </TR>");
//		template.append("        <TR>");
//		template.append("          {{#if frm_nuclear_cardiolo_1.arrhythmia_vt_sust.value}}<td>VT: Sustained (&gt;30 secs) &nbsp;</td>{{/if}}");
//		template.append("          {{#if frm_nuclear_cardiolo_1.arrhythmia_vt_non.value}}<td>VT: Nonustained (&lt;30 secs) &nbsp;</td>{{/if}}");
//		template.append("          {{#if frm_nuclear_cardiolo_1.arrhythmia_vea_coup.value}}<td>Complex VEA: {{frm_nuclear_cardiolo_1.arrhythmia_vea_coup.name}}{{#if frm_nuclear_cardiolo_1.arrhythmia_vea_bitri.value}}; {{frm_nuclear_cardiolo_1.arrhythmia_vea_bitri.name}}{{/if}}</td>{{else}}{{#if frm_nuclear_cardiolo_1.arrhythmia_vea_bitri.value}}<td>Complex VEA: {{frm_nuclear_cardiolo_1.arrhythmia_vea_bitri.name}}</td>{{/if}}{{/if}}");
//		template.append("        </TR>");
//		template.append("        <TR>");
//		template.append("          {{#if frm_nuclear_cardiolo_1.arrhythmia_rate}}<TD>Rate: {{frm_nuclear_cardiolo_1.arrhythmia_rate}}</TD>{{/if}}");
//		template.append("          {{#if frm_nuclear_cardiolo_1.arrhythmia_beats}}<TD>Beats: {{frm_nuclear_cardiolo_1.arrhythmia_beats}}</TD>{{/if}}");
//		template.append("        </TR>");
//		template.append("      </TABLE>");
//		template.append("    </TD>");
//		template.append("  </TR>");
//		template.append("  <tr>");
//		template.append("      <td colspan=\"2\"></td>");
//		template.append("  </tr>");
//		template.append("</TABLE>");
//		template.append("  {{#if frm_nuclear_cardiolo_1.stress_ecg_comments}}");
//		template.append("<strong>Comment:</strong> {{frm_nuclear_cardiolo_1.stress_ecg_comments}}");
//		template.append("  {{/if}}");
//		template.append("");
//		template.append("<!-- Duke Score -->");
//		template.append("");
//		template.append("{{#if frm_nuclear_cardiolo_1.duke_score}}");
//		template.append("</p>");
//		template.append("<strong>Duke ETT Score:</strong> {{frm_nuclear_cardiolo_1.duke_score}} &nbsp;&nbsp;&nbsp;&nbsp;Annual Cardiovascular Mortality Estimated from Duke Score: {{frm_nuclear_cardiolo_1.estimated_mortality}}<br>");
//		template.append("<div style=\"margin-left: 2em; font-size: 9pt;\">Risk status based on AHCPR Publication No. 94-0603 May 1994:<br>");
//		template.append("Low = Annual Mortality < 1%&nbsp;&nbsp;&nbsp;&nbsp;Intermediate = Annual Mortality 2 - 3%&nbsp;&nbsp;&nbsp;&nbsp;High = Annual Mortality 4%");
//		template.append("{{/if}}");
//		template.append("</div>");
//		template.append("</div>");
//		template.append("</p>");
//		template.append("{{/compare}}");
//		template.append("");
//		template.append("<!-- ------------- -->");
//		template.append("<!-- GBPS Protocol -->");
//		template.append("<!-- ------------- -->");
//		template.append("");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure \"==\" \"procGBPS\"}}<hr style=\"display:none\">");
//		template.append("<strong>Imaging Protocol</strong> &nbsp;&nbsp;&nbsp;&nbsp;Imaging Agent: {{frm_nuclear_cardiolo_1.imaging_agent.name}}</p>");
//		template.append("      <div style=\"margin-left: 2em;\">");
//		template.append("    According to standard departmental protocol, gated planar images of the cardiac blood pool were obtained in 2 or more views using {{frm_nuclear_cardiolo_1.gbps_dose}} mci of {{frm_nuclear_cardiolo_1.imaging_agent.name}}. Analysis of regional contraction and global ventricular function was performed.");
//		template.append("{{#if frm_nuclear_cardiolo_1.procedural_comment}}</p><strong>Comment:</strong> {{frm_nuclear_cardiolo_1.procedural_comment}}{{/if}}");
//		template.append("</div>");
//		template.append("</p>");
//		template.append("{{/compare}}");
//		template.append("");
//		template.append("<!-- ------------ -->");
//		template.append("<!-- GBPS Results -->");
//		template.append("<!-- ------------ -->");
//		template.append("");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure \"==\" \"procGBPS\"}}<hr style=\"display:none\">");
//		template.append("    <strong>Gated Blood Pool Scan Results</strong></p>");
//		template.append("    <div style=\"margin-left: 2em;\">");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.all_wnl.value \"==\" \"1\"}}");
//		template.append("            {{#compare frm_nuclear_cardiolo_1.equivocal.value \"!==\" \"1\"}}");
//		template.append("                The results of the study demonstrate normal size and function of all cardiac chambers. The examination is within normal limits. {{frm_nuclear_cardiolo_1.gbps_comment}}");
//		template.append("            {{/compare}}");
//		template.append("            {{#compare frm_nuclear_cardiolo_1.equivocal.value \"==\" \"1\"}}");
//		template.append("                The results of the study do not demonstrate any definite abnormalities. The exam is within normal limits. {{frm_nuclear_cardiolo_1.gbps_comment}}");
//		template.append("            {{/compare}}");
//		template.append("        {{/compare}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.all_wnl.value \"!==\" \"1\"}}");
//		template.append("            The results of the study demonstrate the following:");
//		template.append("            {{#if frm_nuclear_cardiolo_1.ra_wnl.value}}");
//		template.append("                <br><strong>RA:</strong> {{#compare frm_nuclear_cardiolo_1.ra_wnl.value \"==\" \"1\"}}wnl{{else}}abn{{/compare}} &nbsp;&nbsp;{{#frm_nuclear_cardiolo_1.ra_grid}}{{#each this}}{{#if this.value}}<font style=\"text-transform: lowercase;\">{{this.name}}</font>; {{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.ra_grid}}");
//		template.append("            {{/if}}");
//		template.append("            {{#if frm_nuclear_cardiolo_1.rv_wnl.value}}");
//		template.append("                <br><strong>RV:</strong> {{#compare frm_nuclear_cardiolo_1.rv_wnl.value \"==\" \"1\"}}wnl{{else}}abn{{/compare}} &nbsp;&nbsp;{{#frm_nuclear_cardiolo_1.rv_grid}}{{#each this}}{{#if this.value}}<font style=\"text-transform: lowercase;\">{{this.name}}</font>; {{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.rv_grid}}");
//		template.append("            {{/if}}");
//		template.append("            {{#if frm_nuclear_cardiolo_1.pa_wnl.value}}");
//		template.append("                <br><strong>PA:</strong> {{#compare frm_nuclear_cardiolo_1.pa_wnl.value \"==\" \"1\"}}wnl{{else}}abn{{/compare}} &nbsp;&nbsp;{{#frm_nuclear_cardiolo_1.pa_grid}}{{#each this}}{{#if this.value}}<font style=\"text-transform: lowercase;\">{{this.name}}</font>; {{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.pa_grid}}");
//		template.append("            {{/if}}");
//		template.append("            {{#if frm_nuclear_cardiolo_1.la_wnl.value}}");
//		template.append("                <br><strong>LA:</strong> {{#compare frm_nuclear_cardiolo_1.la_wnl.value \"==\" \"1\"}}wnl{{else}}abn{{/compare}} &nbsp;&nbsp;{{#frm_nuclear_cardiolo_1.la_grid}}{{#each this}}{{#if this.value}}<font style=\"text-transform: lowercase;\">{{this.name}}</font>; {{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.la_grid}}");
//		template.append("            {{/if}}");
//		template.append("            {{#if frm_nuclear_cardiolo_1.lv_wnl.value}}");
//		template.append("                <br><strong>LV:</strong> {{#compare frm_nuclear_cardiolo_1.lv_wnl.value \"==\" \"1\"}}wnl{{else}}abn{{/compare}} &nbsp;&nbsp;{{#frm_nuclear_cardiolo_1.lv_grid}}{{#each this}}{{#if this.value}}<font style=\"text-transform: lowercase;\">{{this.name}}</font>; {{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.lv_grid}}");
//		template.append("            {{/if}}");
//		template.append("            {{#if frm_nuclear_cardiolo_1.ao_wnl.value}}");
//		template.append("                <br><strong>AO:</strong> {{#compare frm_nuclear_cardiolo_1.ao_wnl.value \"==\" \"1\"}}wnl{{else}}abn{{/compare}} &nbsp;&nbsp;{{#frm_nuclear_cardiolo_1.ao_grid}}{{#each this}}{{#if this.value}}<font style=\"text-transform: lowercase;\">{{this.name}}</font>; {{/if}}{{/each}}{{/frm_nuclear_cardiolo_1.ao_grid}}");
//		template.append("            {{/if}}");
//		template.append("            <br>{{frm_nuclear_cardiolo_1.gbps_comment}}");
//		template.append("        {{/compare}}");
//		template.append("        </p>");
//		template.append("        <strong>LV EF:</strong> {{#if frm_nuclear_cardiolo_1.ef_unobtain_gbps.value}}Unobtainable{{else}}{{frm_nuclear_cardiolo_1.lvef}}%{{/if}}");
//		template.append("    </div>");
//		template.append("    </p>");
//		template.append("{{/compare}}");
//		template.append("");
//		template.append("<!-- -------------- -->");
//		template.append("<!-- PETMV PROTOCOL -->");
//		template.append("<!-- -------------- -->");
//		template.append("");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure \"==\" \"procPETMV\"}}<hr style=\"display:none\">");
//		template.append("<strong>Imaging Protocol</strong> &nbsp;&nbsp;&nbsp;&nbsp;Pet Myocardial Viability Study: Imaging Agent{{#if frm_nuclear_cardiolo_1.imaging_agent2.value}}s{{/if}}: {{frm_nuclear_cardiolo_1.imaging_agent.name}}{{#if frm_nuclear_cardiolo_1.imaging_agent2.value}}, {{frm_nuclear_cardiolo_1.imaging_agent2.name}}{{/if}}</p>");
//		template.append("      <div style=\"margin-left: 2em;\">");
//		template.append("    According to standard departmental protocol {{#compare frm_nuclear_cardiolo_1.gating_petmv.value \"==\" \"1\"}}ECG gated{{else}}ungated{{/compare}} {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{else}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"5\"}}PET{{else}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"7\"}}PET{{else}}SPECT{{/compare}}{{/compare}}{{/compare}} rest myocardial perfusion images were obtained using {{frm_nuclear_cardiolo_1.rest_perf_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent.name}} administered IV. Subsequently, the patient, whose fasting glucose was less than or equal to 135 mg/dl, was given an oral glucose load according to standard departmental protocal. {{#if frm_nuclear_cardiolo_1.insulin.value}}Blood glucose was measured at 60 min, after which a cumulative total dose of {{frm_nuclear_cardiolo_1.units}} insulin units was given IV. {{/if}}When blood glucose, which was monitored every 30-45 min, had declined to less than or equal to 130, {{frm_nuclear_cardiolo_1.fdg_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent2.name}} was administered IV and {{frm_nuclear_cardiolo_1.imaging_agent2.name}} imaging (static and gated) began approximately 1 hour later.");
//		template.append("{{#if frm_nuclear_cardiolo_1.procedural_comment}}</p><strong>Comment:</strong> {{frm_nuclear_cardiolo_1.procedural_comment}}{{/if}}");
//		template.append("</div>");
//		template.append("</p>");
//		template.append("{{/compare}}");
//		template.append("");
//		template.append("<!-- ------------ -->");
//		template.append("<!-- MPI PROTOCOL -->");
//		template.append("<!-- ------------ -->");
//		template.append("");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure \"==\" \"procMPI\"}}<hr style=\"display:none\">");
//		template.append("<strong>Imaging Protocol</strong> &nbsp;&nbsp;&nbsp;&nbsp;Imaging Agent: {{frm_nuclear_cardiolo_1.imaging_agent.name}}</p>");
//		template.append("<div style=\"margin-left: 2em;\">");
//		template.append("    {{#compare frm_nuclear_cardiolo_1.imaging_agent.name \"==\" \"Thallium\"}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"2\"}}");
//		template.append("            According to standard departmental protocol, a stress test was performed and {{frm_nuclear_cardiolo_1.stress_dose}} mCi of thallium injected IV at peak stress.");
//		template.append("        {{/compare}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"10\"}}");
//		template.append("            According to standard departmental protocol, a pharmacological stress test was performed with IV regadenoson (bolus injection,  400 mcg over 10 to 20 seconds followed by 5 ml flush) after which {{frm_nuclear_cardiolo_1.stress_dose}} mCi of thallium was injected IV  10 to 20 sec later.");
//		template.append("        {{/compare}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"6\"}}");
//		template.append("            According to standard departmental protocol, a pharmacological stress test was performed with IV adenosine infusion (max dose= 140 ug/Kg/min for 4 min 0 sec =  x Kg*0.14mg/Kg/min*4min= x mg) after which {{frm_nuclear_cardiolo_1.stress_dose}} mCi of thallium was injected IV at peak drug effect.");
//		template.append("        {{/compare}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"7\"}}");
//		template.append("            According to standard departmental protocol, a pharmacological stress test was performed with IV adenosine infusion (max dose= 140 ug/Kg/min for 4 min 0 sec =  x Kg*0.14mg/Kg/min*4min= x mg) after which {{frm_nuclear_cardiolo_1.stress_dose}} mCi of thallium was injected IV at peak drug effect.");
//		template.append("        {{/compare}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"8\"}}");
//		template.append("            According to standard departmental protocol, a pharmacological stress test was performed with IV adenosine infusion (max dose= 140 ug/Kg/min for 4 min 0 sec =  x Kg*0.14mg/Kg/min*4min= x mg) after which {{frm_nuclear_cardiolo_1.stress_dose}} mCi of thallium was injected IV at peak drug effect.");
//		template.append("        {{/compare}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"9\"}}");
//		template.append("            According to standard departmental protocol, a pharmacological stress test was performed with IV dobutamine infusion (cumulative dose given based on patient body weight of x Kg = x mg dobutamine) after which {{frm_nuclear_cardiolo_1.stress_dose}} mCi of thallium was injected IV at peak drug effect.");
//		template.append("        {{/compare}}");
//		template.append("        {{frm_nuclear_cardiolo_1.rest_dose}} mCi of thallium was injected IV at rest.  After 10 - 15 minutes, SPECT myocardial images were obtained and assessed for LV size, tracer uptake and distribution. Subsequently, three hours later, SPECT redistribution images were obtained.");
//		template.append("    {{/compare}}");
//		template.append("    {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"7\"}}");
//		template.append("        According to standard departmental protocol, the patient was injected with {{frm_nuclear_cardiolo_1.rest_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent.name}} IV at rest and dynamic images were obtained. Immediately thereafter an 8 FR {{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"1\"}}ECG gated {{/compare}}{{#compare frm_nuclear_cardiolo_1.gating.value \"!==\" \"1\"}}ungated {{/compare}}acquisition of the residual myocardial tracer was acquired. Next, after 30 to 60 min, a pharmacological stress test was performed with IV");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"6\"}}");
//		template.append("            adenosine ({{frm_nuclear_cardiolo_1.max_dose.value}} ug/Kg/min for {{frm_nuclear_cardiolo_1.time_max_dose_min}} min {{frm_nuclear_cardiolo_1.time_max_dose_sec}} sec)");
//		template.append("        {{/compare}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"7\"}}");
//		template.append("            adenosine ({{frm_nuclear_cardiolo_1.max_dose.value}} ug/Kg/min for {{frm_nuclear_cardiolo_1.time_max_dose_min}} min {{frm_nuclear_cardiolo_1.time_max_dose_sec}} sec)");
//		template.append("        {{/compare}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"8\"}}");
//		template.append("            adenosine ({{frm_nuclear_cardiolo_1.max_dose.value}} ug/Kg/min for {{frm_nuclear_cardiolo_1.time_max_dose_min}} min {{frm_nuclear_cardiolo_1.time_max_dose_sec}} sec)");
//		template.append("        {{/compare}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"10\"}}");
//		template.append("            regagenoson ({{frm_nuclear_cardiolo_1.max_dose.value}} mcg bolus injection followed by a 5ml flush)");
//		template.append("        {{/compare}}");
//		template.append("        and 10-20 sec later {{frm_nuclear_cardiolo_1.stress_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent.name}} injected, after which a second dynamic PET myocardial data acquisition was obtained.");
//		template.append("    {{/compare}}");
//		template.append("    {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"5\"}}");
//		template.append("        According to standard departmental protocol, the patient was injected with {{frm_nuclear_cardiolo_1.rest_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent.name}} IV at rest and dynamic images were obtained. Immediately thereafter an 8 FR {{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"1\"}}ECG gated {{/compare}}{{#compare frm_nuclear_cardiolo_1.gating.value \"!==\" \"1\"}}ungated {{/compare}}acquisition of the residual myocardial tracer was acquired. Next, after 30 to 60 min, a pharmacological stress test was performed with IV");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"6\"}}");
//		template.append("            adenosine ({{frm_nuclear_cardiolo_1.max_dose.value}} ug/Kg/min for {{frm_nuclear_cardiolo_1.time_max_dose_min}} min {{frm_nuclear_cardiolo_1.time_max_dose_sec}} sec)");
//		template.append("        {{/compare}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"7\"}}");
//		template.append("            adenosine ({{frm_nuclear_cardiolo_1.max_dose.value}} ug/Kg/min for {{frm_nuclear_cardiolo_1.time_max_dose_min}} min {{frm_nuclear_cardiolo_1.time_max_dose_sec}} sec)");
//		template.append("        {{/compare}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"8\"}}");
//		template.append("            adenosine ({{frm_nuclear_cardiolo_1.max_dose.value}} ug/Kg/min for {{frm_nuclear_cardiolo_1.time_max_dose_min}} min {{frm_nuclear_cardiolo_1.time_max_dose_sec}} sec)");
//		template.append("        {{/compare}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"10\"}}");
//		template.append("            regagenoson ({{frm_nuclear_cardiolo_1.max_dose.value}} mcg bolus injection followed by a 5ml flush)");
//		template.append("        {{/compare}}");
//		template.append("        and 10-20 sec later {{frm_nuclear_cardiolo_1.stress_dose}} mCi of 18f-FDG injected, after which a second dynamic PET myocardial data acquisition was obtained.");
//		template.append("    {{/compare}}");
//		template.append("    {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"2\"}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"5\"}}");
//		template.append("            {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"7\"}}");
//		template.append("                According to standard departmental protocol, the patient was injected with {{frm_nuclear_cardiolo_1.rest_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent.name}} IV at rest and {{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"1\"}}ECG gated {{/compare}}{{#compare frm_nuclear_cardiolo_1.gating.value \"!==\" \"1\"}}ungated {{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} myocardial images were");
//		template.append("                {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"1\"}}");
//		template.append("                    obtained.");
//		template.append("                    {{#compare frm_nuclear_cardiolo_1.gating.value \"!==\" \"2\"}}LV size and function as well as perfusion were assessed in the gated images.");
//		template.append("                    {{/compare}}");
//		template.append("                {{/compare}}");
//		template.append("                {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"2\"}}");
//		template.append("                    obtained. Subsequently, a stress test was performed and {{frm_nuclear_cardiolo_1.stress_dose}} mci of {{frm_nuclear_cardiolo_1.imaging_agent.name}} injected IV at peak stress{{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"2\"}}. After 30-60 minutes, gated {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for LV size, contractile function, and perfusion.{{/compare}}{{#compare frm_nuclear_cardiolo_1.gating.value \"!==\" \"2\"}}, after which ungated {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for LV size and perfusion.{{/compare}}");
//		template.append("                {{/compare}}");
//		template.append("                {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"3\"}}");
//		template.append("                    obtained. Subsequently, a stress test was performed and {{frm_nuclear_cardiolo_1.stress_dose}} mci of {{frm_nuclear_cardiolo_1.imaging_agent.name}} injected IV at peak stress{{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"2\"}}. After 30-60 minutes, gated {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for LV size, contractile function, and perfusion.{{/compare}}{{#compare frm_nuclear_cardiolo_1.gating.value \"!==\" \"2\"}}, after which ungated {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for LV size and perfusion.{{/compare}}");
//		template.append("                {{/compare}}");
//		template.append("                {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"4\"}}");
//		template.append("                    obtained. Subsequently, a stress test was performed and {{frm_nuclear_cardiolo_1.stress_dose}} mci of {{frm_nuclear_cardiolo_1.imaging_agent.name}} injected IV at peak stress{{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"2\"}}. After 30-60 minutes, gated {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for LV size, contractile function, and perfusion.{{/compare}}{{#compare frm_nuclear_cardiolo_1.gating.value \"!==\" \"2\"}}, after which ungated {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for LV size and perfusion.{{/compare}}");
//		template.append("                {{/compare}}");
//		template.append("                {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"7\"}}");
//		template.append("                    obtained. Subsequently, a pharmacological stress test was performed with IV adenosine infusion (max dose= {{frm_nuclear_cardiolo_1.max_dose.name}} ug/Kg/min for {{frm_nuclear_cardiolo_1.time_max_dose_min}} min {{frm_nuclear_cardiolo_1.time_max_dose_sec}} sec = {{frm_nuclear_cardiolo_1.weight_kg}}Kg*{{frm_nuclear_cardiolo_1.max_dose_frac}}mg/Kg/min*{{frm_nuclear_cardiolo_1.max_dose_min_dec}}min={{frm_nuclear_cardiolo_1.max_dose_calc}}mg){{#if frm_nuclear_cardiolo_1.stress_dose}}after which {{frm_nuclear_cardiolo_1.stress_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent.name}} was injected IV at peak drug effect. {{/if}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}Dynamic PET images where obtained between 5 and 10 minutes after tracer injection and assesed for myocarial perfusion.{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}. After 30 to 60 minutes, {{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"2\"}}gated{{else}}ungated{{/compare}} {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for myocardial perfusion and LV function.");
//		template.append("                    {{/compare}}");
//		template.append("                {{/compare}}");
//		template.append("                {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"8\"}}");
//		template.append("                    obtained. Subsequently, a pharmacological stress test was performed with IV adenosine infusion (max dose= {{frm_nuclear_cardiolo_1.max_dose.name}} ug/Kg/min for {{frm_nuclear_cardiolo_1.time_max_dose_min}} min {{frm_nuclear_cardiolo_1.time_max_dose_sec}} sec = {{frm_nuclear_cardiolo_1.weight_kg}}Kg*{{frm_nuclear_cardiolo_1.max_dose_frac}}mg/Kg/min*{{frm_nuclear_cardiolo_1.max_dose_min_dec}}min={{frm_nuclear_cardiolo_1.max_dose_calc}}mg){{#if frm_nuclear_cardiolo_1.stress_dose}}after which {{frm_nuclear_cardiolo_1.stress_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent.name}} was injected IV at peak drug effect. {{/if}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}Dynamic PET images where obtained between 5 and 10 minutes after tracer injection and assesed for myocarial perfusion.{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}. After 30 to 60 minutes, {{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"2\"}}gated{{else}}ungated{{/compare}} {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for myocardial perfusion and LV function.");
//		template.append("                    {{/compare}}");
//		template.append("                {{/compare}}");
//		template.append("                {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"6\"}}");
//		template.append("                    obtained. Subsequently, a pharmacological stress test was performed with IV adenosine infusion (max dose= {{frm_nuclear_cardiolo_1.max_dose.name}} ug/Kg/min for {{frm_nuclear_cardiolo_1.time_max_dose_min}} min {{frm_nuclear_cardiolo_1.time_max_dose_sec}} sec = {{frm_nuclear_cardiolo_1.weight_kg}}Kg*{{frm_nuclear_cardiolo_1.max_dose_frac}}mg/Kg/min*{{frm_nuclear_cardiolo_1.max_dose_min_dec}}min={{frm_nuclear_cardiolo_1.max_dose_calc}}mg){{#if frm_nuclear_cardiolo_1.stress_dose}}after which {{frm_nuclear_cardiolo_1.stress_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent.name}} was injected IV at peak drug effect. {{/if}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}Dynamic PET images where obtained between 5 and 10 minutes after tracer injection and assesed for myocarial perfusion.{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}. After 30 to 60 minutes, {{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"2\"}}gated{{else}}ungated{{/compare}} {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for myocardial perfusion and LV function.");
//		template.append("                    {{/compare}}");
//		template.append("                {{/compare}}");
//		template.append("                {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"9\"}}");
//		template.append("                    obtained. Subsequently, a pharmacological stress test was performed with IV dobutamine (cumulative dose given based on patient body weight of {{frm_nuclear_cardiolo_1.weight_kg}}Kg = {{frm_nuclear_cardiolo_1.dob_cum_dose_calc}}mg dobutamine){{#if frm_nuclear_cardiolo_1.stress_dose}}, after which {{frm_nuclear_cardiolo_1.stress_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent.name}} was injected IV at peak drug effect{{/if}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}. Dynamic PET images where obtained between 5 and 10 minutes after tracer injection and assesed for myocarial perfusion.{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}. After 30 to 60 minutes, {{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"2\"}}gated{{else}}ungated{{/compare}} {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for myocardial perfusion and LV function.");
//		template.append("                    {{/compare}}");
//		template.append("                {{/compare}}");
//		template.append("                {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"10\"}}");
//		template.append("                    obtained. Subsequently, a pharmacological stress test was performed with IV regadenoson (bolus injection, {{frm_nuclear_cardiolo_1.max_dose.name}} mcg over 10 to 20 seconds followed by 5 ml flush){{#if frm_nuclear_cardiolo_1.stress_dose}}, after which {{frm_nuclear_cardiolo_1.stress_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent.name}} was injected IV 60 seconds later{{/if}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}. Dynamic PET images where obtained between 5 and 10 minutes after tracer injection and assesed for myocarial perfusion.{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}. After 30 to 60 minutes, {{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"2\"}}gated{{else}}ungated{{/compare}} {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for myocardial perfusion and LV function.");
//		template.append("                    {{/compare}}");
//		template.append("                {{/compare}}");
//		template.append("                {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"12\"}}");
//		template.append("                    obtained. Subsequently, a pharmacological stress test was performed with IV dipry dobutamine (cumulative dose given based on patient body weight of {{frm_nuclear_cardiolo_1.weight_kg}}Kg = {{frm_nuclear_cardiolo_1.dob_cum_dose_calc}}mg dobutamine){{#if frm_nuclear_cardiolo_1.stress_dose}}, after which {{frm_nuclear_cardiolo_1.stress_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent.name}} was injected IV at peak drug effect{{/if}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}. Dynamic PET images where obtained between 5 and 10 minutes after tracer injection and assesed for myocarial perfusion.{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}. After 30 to 60 minutes, {{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"2\"}}gated{{else}}ungated{{/compare}} {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for myocardial perfusion and LV function.");
//		template.append("                    {{/compare}}");
//		template.append("                {{/compare}}");
//		template.append("                {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"13\"}}");
//		template.append("                    obtained. Subsequently, a pharmacological stress test was performed with IV dipry dobutamine (cumulative dose given based on patient body weight of {{frm_nuclear_cardiolo_1.weight_kg}}Kg = {{frm_nuclear_cardiolo_1.dob_cum_dose_calc}}mg dobutamine){{#if frm_nuclear_cardiolo_1.stress_dose}}, after which {{frm_nuclear_cardiolo_1.stress_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent.name}} was injected IV at peak drug effect{{/if}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}. Dynamic PET images where obtained between 5 and 10 minutes after tracer injection and assesed for myocarial perfusion.{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}. After 30 to 60 minutes, {{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"2\"}}gated{{else}}ungated{{/compare}} {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for myocardial perfusion and LV function.");
//		template.append("                    {{/compare}}");
//		template.append("                {{/compare}}");
//		template.append("                {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"11\"}}");
//		template.append("                    obtained. Subsequently, a pharmacological stress test was performed with IV dipyridamole (dose given based on patient body weight of {{frm_nuclear_cardiolo_1.weight_kg}}Kg *.56mg = {{frm_nuclear_cardiolo_1.dipyridamole_dose_calc}}mg dipyridamole){{#if frm_nuclear_cardiolo_1.stress_dose}}, after which {{frm_nuclear_cardiolo_1.stress_dose}} mCi of {{frm_nuclear_cardiolo_1.imaging_agent.name}} was injected IV at peak drug effect{{/if}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}. Dynamic PET images where obtained between 5 and 10 minutes after tracer injection and assesed for myocarial perfusion.{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}. After 30 to 60 minutes, {{#compare frm_nuclear_cardiolo_1.gating.value \"==\" \"2\"}}gated{{else}}ungated{{/compare}} {{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"!==\" \"4\"}}SPECT{{/compare}}{{#compare frm_nuclear_cardiolo_1.imaging_agent.value \"==\" \"4\"}}PET{{/compare}} images were obtained and assessed for myocardial perfusion and LV function.");
//		template.append("                    {{/compare}}");
//		template.append("                {{/compare}}");
//		template.append("            {{/compare}}");
//		template.append("        {{/compare}}");
//		template.append("    {{/compare}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.procedural_comment}}</p><strong>Comment:</strong> {{frm_nuclear_cardiolo_1.procedural_comment}}{{/if}}");
//		template.append("</div>");
//		template.append("</p>");
//		template.append("{{/compare}}");
//		template.append("");
//		template.append("<!-- --------------- -->");
//		template.append("<!-- IMAGING RESULTS -->");
//		template.append("<!-- --------------- -->");
//		template.append("");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure \"!==\" \"\"}}{{#compare frm_nuclear_cardiolo_1.procedure \"!==\" \"procGBPS\"}}{{#compare frm_nuclear_cardiolo_1.procedure \"!==\" \"procNIETT\"}}{{#unless frm_nuclear_cardiolo_1.imaging_agent2.name}}<hr style=\"display:none\">");
//		template.append("<strong>Imaging Results</strong></p>");
//		template.append("    <div style=\"margin-left: 2em;\">");
//		template.append("<TABLE WIDTH=\"100%\">");
//		template.append("    <TR>");
//		template.append("        <TD VALIGN=\"top\" WIDTH=\"50%\"><strong>Perfusion:</strong> {{frm_nuclear_cardiolo_1.perfusion_abnormalities.name}}{{#if frm_nuclear_cardiolo_1.perfusion_table}}<BR />{{/if}}");
//		template.append("          <TABLE BORDER=\"0\" CELLSPACING=\"0\" ALIGN=\"left\" WIDTH=\"90%\">");
//		template.append("              {{#if frm_nuclear_cardiolo_1.perfusion_table}}");
//		template.append("        <TR>");
//		template.append("          <TH ALIGN=\"left\"><strong>Zone</strong></TH>");
//		template.append("          <TH ALIGN=\"left\"><strong>Defect</strong></TH>");
//		template.append("          <TH ALIGN=\"left\"><strong>Change</strong></TH>");
//		template.append("        </TR>");
//		template.append("        {{/if}}");
//		template.append("        {{#each frm_nuclear_cardiolo_1.perfusion_table}}");
//		template.append("        <TR>");
//		template.append("          <TD>{{perf_zone.name}}&nbsp;</TD>");
//		template.append("          <TD>{{perf_defect.name}}&nbsp;</TD>");
//		template.append("          <TD>{{perf_change.name}}&nbsp;</TD>");
//		template.append("        </TR>");
//		template.append("        {{/each}}");
//		template.append("            </TABLE>");
//		template.append("        </TD>");
//		template.append("        <TD VALIGN=\"top\" ALIGN=\"left\"><strong>Regional Wall Motion:</strong> {{frm_nuclear_cardiolo_1.wall_motion_abnormalities.name}}{{#if frm_nuclear_cardiolo_1.wall_motion_table}}<BR />{{/if}}");
//		template.append("            <TABLE FRAME=\"box\" BORDER=\"0\" ALIGN=\"left\" WIDTH=\"70%\">");
//		template.append("        {{#if frm_nuclear_cardiolo_1.wall_motion_table}}");
//		template.append("        <TR>");
//		template.append("          <TH ALIGN=\"left\"><strong>Zone</strong></TH>");
//		template.append("          <TH ALIGN=\"left\"><strong>Wall Motion</strong></TH>");
//		template.append("        </TR>");
//		template.append("        {{/if}}");
//		template.append("        {{#each frm_nuclear_cardiolo_1.wall_motion_table}}");
//		template.append("        <TR>");
//		template.append("          <TD>{{wm_zone.name}}&nbsp;</TD>");
//		template.append("          <TD>{{wm_wall_motion.name}}&nbsp;</TD>");
//		template.append("        </TR>");
//		template.append("        {{/each}}");
//		template.append("      </TABLE>");
//		template.append("        </TD>");
//		template.append("    </TR>");
//		template.append("  <TR>");
//		template.append("    <TD VALIGN=\"top\" COLSPAN=\"2\"><div style=\"height: 4px; overflow:hidden;\"></div></td>");
//		template.append("  </TR>");
//		template.append("    <TR>");
//		template.append("        <TD VALIGN=\"top\" COLSPAN=\"2\">{{#if frm_nuclear_cardiolo_1.lv_ef}}<strong>LV EF:</strong> {{frm_nuclear_cardiolo_1.lv_ef}}% &nbsp;&nbsp;&nbsp;&nbsp;{{/if}}{{# if frm_nuclear_cardiolo_1.ef_unobtain.value}}<strong>LV EF:</strong> Unobtainable &nbsp;&nbsp;&nbsp;&nbsp;{{/if}}{{#if frm_nuclear_cardiolo_1.lv_normal.value}}LV size is normal at rest. &nbsp;&nbsp;&nbsp;&nbsp;{{/if}}{{#if frm_nuclear_cardiolo_1.ef_comment}}{{frm_nuclear_cardiolo_1.ef_comment}}{{/if}}");
//		template.append("        </TD>");
//		template.append("    </TR>");
//		template.append("</TABLE>");
//		template.append("Artifacts: {{#if frm_nuclear_cardiolo_1.artifacts_table}}{{#each frm_nuclear_cardiolo_1.artifacts_table}}{{art_name.name}} <font style=\"text-transform: lowercase;\">{{art_zone.name}}</font>; {{/each}}{{else}}None{{/if}}&nbsp;&nbsp;&nbsp;&nbsp;");
//		template.append("{{#if frm_nuclear_cardiolo_1.extra_card.name}}Extra Cardiac Uptake: {{frm_nuclear_cardiolo_1.extra_card.name}}&nbsp;&nbsp;&nbsp;&nbsp;{{/if}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.rv_dilation.name}}RV Dilation: {{frm_nuclear_cardiolo_1.rv_dilation.name}}&nbsp;&nbsp;&nbsp;&nbsp;{{/if}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.lv_dilation_rest.name}}LV Dilation (rest): {{frm_nuclear_cardiolo_1.lv_dilation_rest.name}}&nbsp;&nbsp;&nbsp;&nbsp;{{/if}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.lv_dilation_stress.name}}LV Dilation (stress): {{frm_nuclear_cardiolo_1.lv_dilation_stress.name}}&nbsp;&nbsp;&nbsp;&nbsp;{{/if}}");
//		template.append("<br>");
//		template.append("{{frm_nuclear_cardiolo_1.imaging_comment}}");
//		template.append("</div>");
//		template.append("</p>");
//		template.append("{{/unless}}{{/compare}}{{/compare}}{{/compare}}");
//		template.append("");
//		template.append("<!-- -------------------- -->");
//		template.append("<!-- DUAL IMAGING RESULTS -->");
//		template.append("<!-- -------------------- -->");
//		template.append("");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure \"!==\" \"\"}}{{#compare frm_nuclear_cardiolo_1.procedure \"==\" \"procPETMV\"}}{{#if frm_nuclear_cardiolo_1.imaging_agent2.value}}<hr style=\"display:none\">");
//		template.append("<strong>Imaging Results</strong></p>");
//		template.append("<div style=\"margin-left: 2em;\">");
//		template.append("<TABLE WIDTH=\"100%\">");
//		template.append("    <TR>");
//		template.append("        <TD VALIGN=\"top\" WIDTH=\"50%\">Agent: {{frm_nuclear_cardiolo_1.imaging_agent.name}}</TD>");
//		template.append("        <TD VALIGN=\"top\">Agent: {{frm_nuclear_cardiolo_1.imaging_agent2.name}}</TD>");
//		template.append("    </TR>");
//		template.append("    <TR>");
//		template.append("        <TD VALIGN=\"top\">");
//		template.append("                    <strong>Perfusion:</strong>");
//		template.append("                    {{frm_nuclear_cardiolo_1.perfusion_abnormalities.name}}{{#if frm_nuclear_cardiolo_1.perfusion_table}}<BR />{{/if}}");
//		template.append("                        <TABLE BORDER=\"0\" CELLSPACING=\"0\" ALIGN=\"left\" WIDTH=\"90%\">");
//		template.append("                            {{#if frm_nuclear_cardiolo_1.perfusion_table}}");
//		template.append("                            <TR>");
//		template.append("                                <TH ALIGN=\"left\"><strong>Zone&nbsp;&nbsp;</strong></TH>");
//		template.append("                                <TH ALIGN=\"left\"><strong>Defect&nbsp;&nbsp;</strong></TH>");
//		template.append("                            </TR>");
//		template.append("                            {{else}}");
//		template.append("                            <TR>");
//		template.append("                                <TH ALIGN=\"left\"><strong>&nbsp;</strong></TH>");
//		template.append("                                <TH ALIGN=\"left\"><strong>&nbsp;</strong></TH>");
//		template.append("                            </TR>");
//		template.append("                            {{/if}}");
//		template.append("                            {{#each frm_nuclear_cardiolo_1.perfusion_table}}");
//		template.append("                            <TR>");
//		template.append("                                <TD>{{perf_zone.name}}&nbsp;&nbsp;</TD>");
//		template.append("                                <TD>{{perf_defect.name}}&nbsp;</TD>");
//		template.append("                            </TR>");
//		template.append("                            {{/each}}");
//		template.append("                        </TABLE>");
//		template.append("        </TD>");
//		template.append("        <TD VALIGN=\"top\">");
//		template.append("                    <strong>Metabolism:</strong> {{frm_nuclear_cardiolo_1.uptake_abnormalities2.name}}{{#if frm_nuclear_cardiolo_1.uptake_table2}}<BR />{{/if}}");
//		template.append("                        <TABLE BORDER=\"0\" CELLSPACING=\"0\" ALIGN=\"left\" WIDTH=\"90%\">");
//		template.append("                            {{#if frm_nuclear_cardiolo_1.uptake_table2}}");
//		template.append("                            <TR>");
//		template.append("                                <TH ALIGN=\"left\"><strong>Zone&nbsp;&nbsp;</strong></TH>");
//		template.append("                                <TH ALIGN=\"left\"><strong>Uptake Reduction</strong></TH>");
//		template.append("                            </TR>");
//		template.append("                            {{else}}");
//		template.append("                            <TR>");
//		template.append("                                <TH ALIGN=\"left\"><strong>&nbsp;</strong></TH>");
//		template.append("                                <TH ALIGN=\"left\"><strong>&nbsp;</strong></TH>");
//		template.append("                            </TR>");
//		template.append("                            {{/if}}");
//		template.append("                            {{#each frm_nuclear_cardiolo_1.uptake_table2}}");
//		template.append("                            <TR>");
//		template.append("                                <TD>{{uptake_zone2.name}}&nbsp;&nbsp;</TD>");
//		template.append("                                <TD>{{uptake_defect2.name}}</TD>");
//		template.append("                            </TR>");
//		template.append("                            {{/each}}");
//		template.append("                        </TABLE>");
//		template.append("        </TD>");
//		template.append("    </TR>");
//		template.append("    <TR>");
//		template.append("        <TD VALIGN=\"top\"><strong>Regional Wall Motion:</strong> {{frm_nuclear_cardiolo_1.wall_motion_abnormalities.name}}</TD>");
//		template.append("        <TD VALIGN=\"top\"><strong>Regional Wall Motion:</strong> {{frm_nuclear_cardiolo_1.wall_motion_abnormalities2.name}}</TD>");
//		template.append("    </TR>");
//		template.append("    <TR>");
//		template.append("        <TD VALIGN=\"top\">");
//		template.append("                    {{#if frm_nuclear_cardiolo_1.lv_ef}}<strong>LV EF:</strong> {{frm_nuclear_cardiolo_1.lv_ef}}% &nbsp;&nbsp;&nbsp;&nbsp;{{/if}}{{#if frm_nuclear_cardiolo_1.ef_unobtain.value}}<strong>LV EF:</strong> Unobtainable &nbsp;&nbsp;&nbsp;&nbsp;{{/if}}{{#if frm_nuclear_cardiolo_1.lv_normal.value}}LV size is normal at rest. &nbsp;&nbsp;&nbsp;&nbsp;{{/if}}{{#if frm_nuclear_cardiolo_1.ef_unobtain_comment}}{{frm_nuclear_cardiolo_1.ef_unobtain_comment}} &nbsp;&nbsp;&nbsp;&nbsp;{{/if}}{{#if frm_nuclear_cardiolo_1.ef_comment}}{{frm_nuclear_cardiolo_1.ef_comment}} &nbsp;{{/if}}</TD>");
//		template.append("        <TD VALIGN=\"top\">");
//		template.append("                    {{#if frm_nuclear_cardiolo_1.lv_ef2}}<strong>LV EF:</strong> {{frm_nuclear_cardiolo_1.lv_ef2}}% &nbsp;&nbsp;&nbsp;&nbsp;{{/if}}{{#if frm_nuclear_cardiolo_1.ef_unobtain2.value}}<strong>LV EF:</strong> Unobtainable &nbsp;&nbsp;&nbsp;&nbsp;{{/if}}{{#if frm_nuclear_cardiolo_1.lv_normal2.value}}LV size is normal at rest. &nbsp;&nbsp;&nbsp;&nbsp;{{/if}}{{#if frm_nuclear_cardiolo_1.ef_unobtain_comment2}}{{frm_nuclear_cardiolo_1.ef_unobtain_comment2}} &nbsp;&nbsp;&nbsp;&nbsp;{{/if}}{{#if frm_nuclear_cardiolo_1.ef_comment2}}{{frm_nuclear_cardiolo_1.ef_comment2}} &nbsp;{{/if}}</TD>");
//		template.append("    </TR>");
//		template.append("    <TR>");
//		template.append("        <TD VALIGN=\"top\">");
//		template.append("            <TABLE ALIGN=\"left\">");
//		template.append("                {{#if frm_nuclear_cardiolo_1.wall_motion_table}}");
//		template.append("                <TR>");
//		template.append("                    <TH ALIGN=\"left\"><strong>Zone&nbsp;&nbsp;</strong></TH>");
//		template.append("                    <TH ALIGN=\"left\"><strong>Wall Motion&nbsp;&nbsp;</strong></TH>");
//		template.append("                </TR>");
//		template.append("                {{else}}");
//		template.append("                <TR>");
//		template.append("                    <TH ALIGN=\"left\"><strong>&nbsp;</strong></TH>");
//		template.append("                    <TH ALIGN=\"left\"><strong>&nbsp;</strong></TH>");
//		template.append("                </TR>");
//		template.append("                {{/if}}");
//		template.append("                {{#each frm_nuclear_cardiolo_1.wall_motion_table}}");
//		template.append("                <TR>");
//		template.append("                    <TD>{{wm_zone.name}}&nbsp;&nbsp;</TD>");
//		template.append("                    <TD>{{wm_wall_motion.name}}&nbsp;&nbsp;</TD>");
//		template.append("                </TR>");
//		template.append("                {{/each}}");
//		template.append("            </TABLE>");
//		template.append("        </TD>");
//		template.append("        <TD VALIGN=\"top\">");
//		template.append("            <TABLE ALIGN=\"left\">");
//		template.append("                {{#if frm_nuclear_cardiolo_1.wall_motion_table2}}");
//		template.append("                <TR>");
//		template.append("                    <TH ALIGN=\"left\"><strong>Zone&nbsp;&nbsp;</strong></TH>");
//		template.append("                    <TH ALIGN=\"left\"><strong>Wall Motion</strong></TH>");
//		template.append("                </TR>");
//		template.append("                {{else}}");
//		template.append("                <TR>");
//		template.append("                    <TH ALIGN=\"left\"><strong>&nbsp;</strong></TH>");
//		template.append("                    <TH ALIGN=\"left\"><strong>&nbsp;</strong></TH>");
//		template.append("                </TR>");
//		template.append("                {{/if}}");
//		template.append("                {{#each frm_nuclear_cardiolo_1.wall_motion_table2}}");
//		template.append("                <TR>");
//		template.append("                    <TD>{{wm_zone2.name}}&nbsp;&nbsp;</TD>");
//		template.append("                    <TD>{{wm_wall_motion2.name}}&nbsp;</TD>");
//		template.append("                </TR>");
//		template.append("                {{/each}}");
//		template.append("            </TABLE>");
//		template.append("        </TD>");
//		template.append("    </TR>");
//		template.append("    <TR>");
//		template.append("        <TD VALIGN=\"top\"><strong>Comments</strong><BR>");
//		template.append("                    Artifacts: {{#if frm_nuclear_cardiolo_1.artifacts_table}}{{#each frm_nuclear_cardiolo_1.artifacts_table}}{{art_name.name}} <font style=\"text-transform: lowercase;\">{{art_zone.name}}</font>; {{/each}}{{else}}None;{{/if}}&nbsp;&nbsp;&nbsp;&nbsp;");
//		template.append("                    {{#if frm_nuclear_cardiolo_1.extra_card.name}}Extra Cardiac Uptake: {{frm_nuclear_cardiolo_1.extra_card.name}};&nbsp;&nbsp;&nbsp;&nbsp;{{/if}}");
//		template.append("                    {{#if frm_nuclear_cardiolo_1.rv_dilation.name}}RV Dilation: {{frm_nuclear_cardiolo_1.rv_dilation.name}};&nbsp;&nbsp;&nbsp;&nbsp;{{/if}}");
//		template.append("                    {{#if frm_nuclear_cardiolo_1.lv_dilation_rest.name}}LV Dilation (rest): {{frm_nuclear_cardiolo_1.lv_dilation_rest.name}};&nbsp;&nbsp;&nbsp;&nbsp;{{/if}}");
//		template.append("                    {{#if frm_nuclear_cardiolo_1.lv_dilation_stress.name}}LV Dilation (stress): {{frm_nuclear_cardiolo_1.lv_dilation_stress.name}}&nbsp;&nbsp;&nbsp;&nbsp;{{/if}}");
//		template.append("                    <br>");
//		template.append("            {{frm_nuclear_cardiolo_1.imaging_comment}}<BR/>");
//		template.append("        </TD>");
//		template.append("        <TD VALIGN=\"top\"><strong>Comments re metabolism and wm</strong><BR>");
//		template.append("                    Artifacts: {{#if frm_nuclear_cardiolo_1.artifacts_table2}}{{#each frm_nuclear_cardiolo_1.artifacts_table2}}{{art_name2.name}} <font style=\"text-transform: lowercase;\">{{art_zone2.name}}</font>; {{/each}}{{else}}None;{{/if}}&nbsp;&nbsp;&nbsp;&nbsp;");
//		template.append("                    {{#if frm_nuclear_cardiolo_1.extra_card2.name}}Extra Cardiac Uptake: {{frm_nuclear_cardiolo_1.extra_card2.name}};&nbsp;&nbsp;&nbsp;&nbsp;{{/if}}");
//		template.append("                    {{#if frm_nuclear_cardiolo_1.rv_dilation2.name}}RV Dilation: {{frm_nuclear_cardiolo_1.rv_dilation2.name}};&nbsp;&nbsp;&nbsp;&nbsp;{{/if}}");
//		template.append("                    {{#if frm_nuclear_cardiolo_1.lv_dilation_rest2.name}}LV Dilation (rest): {{frm_nuclear_cardiolo_1.lv_dilation_rest2.name}};&nbsp;&nbsp;&nbsp;&nbsp;{{/if}}");
//		template.append("                    {{#if frm_nuclear_cardiolo_1.lv_dilation_stress2.name}}LV Dilation (stress): {{frm_nuclear_cardiolo_1.lv_dilation_stress2.name}}&nbsp;&nbsp;&nbsp;&nbsp;{{/if}}");
//		template.append("                    <br>");
//		template.append("            {{frm_nuclear_cardiolo_1.imaging_comment2}}<BR/>");
//		template.append("        </TD>");
//		template.append("    </TR>");
//		template.append("</TABLE>");
//		template.append("        <strong>Non Cardiac Findings</strong><br>");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.non_cardiac_results.value \"==\" \"0\"}}The CT attenuations scan and FDG images of the chest did not reveal any noncardiac abnormalities. {{/compare}}{{#compare frm_nuclear_cardiolo_1.non_cardiac_results.value \"==\" \"ct\"}}The CT attenuation scan of the chest revealed the following noncardiac abnormalities: {{/compare}}{{#compare frm_nuclear_cardiolo_1.non_cardiac_results.value \"==\" \"fdg\"}}The FDG scan of the chest revealed the following noncardiac abnormalities: {{/compare}}{{#compare frm_nuclear_cardiolo_1.non_cardiac_results.value \"==\" \"ctfdg\"}}The CT and FDG scans of the chest revealed the following noncardiac abnormalities: {{/compare}}<br>");
//		template.append("        {{frm_nuclear_cardiolo_1.non_cardiac_comment}}");
//		template.append("</div>");
//		template.append("</p>");
//		template.append("{{/if}}{{/compare}}{{/compare}}");
//		template.append("");
//		template.append("<!-- ---------- -->");
//		template.append("<!-- CONCLUSION -->");
//		template.append("<!-- ---------- -->");
//		template.append("");
//		template.append("<hr style=\"display:none\">");
//		template.append("");
//		template.append("<br><strong>Conclusion</strong><br>");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"2\"}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.mets.value}}");
//		template.append("The patient has {{#compare frm_nuclear_cardiolo_1.mets.name \"<=\" 5}}reduced{{/compare}}{{#compare frm_nuclear_cardiolo_1.mets.name \">\" 5}}{{#compare frm_nuclear_cardiolo_1.mets.name \"<=\" 7}}normal{{/compare}}{{#compare frm_nuclear_cardiolo_1.mets.name \">\" 7}}{{#compare frm_nuclear_cardiolo_1.mets.name \"<=\" 9}}good{{/compare}}{{/compare}}{{#compare frm_nuclear_cardiolo_1.mets.name \">\" 9}}excellent{{/compare}}{{/compare}} exercise capacity ({{frm_nuclear_cardiolo_1.mets.name}} METS).");
//		template.append("{{/if}}");
//		template.append("{{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"3\"}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.mets.value}}");
//		template.append("While exercise tolerance cannot be fully assessed due to the use of a Modified Bruce Protocol, the patient achieved {{frm_nuclear_cardiolo_1.mets.name}} METS, which is consistent with {{#compare frm_nuclear_cardiolo_1.mets.name \"<=\" 5}}reduced{{/compare}}{{#compare frm_nuclear_cardiolo_1.mets.name \">\" 5}}{{#compare frm_nuclear_cardiolo_1.mets.name \"<=\" 7}}normal{{/compare}}{{#compare frm_nuclear_cardiolo_1.mets.name \">\" 7}}{{#compare frm_nuclear_cardiolo_1.mets.name \"<=\" 9}}good{{/compare}}{{/compare}}{{#compare frm_nuclear_cardiolo_1.mets.name \">\" 9}}excellent{{/compare}}{{/compare}} exercise capacity.");
//		template.append("{{/if}}");
//		template.append("{{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"4\"}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.mets.value}}");
//		template.append("While exercise tolerance cannot be fully assessed due to the use of a Modified Bruce Protocol, the patient achieved {{frm_nuclear_cardiolo_1.mets.name}} METS, which is consistent with {{#compare frm_nuclear_cardiolo_1.mets.name \"<=\" 5}}reduced{{/compare}}{{#compare frm_nuclear_cardiolo_1.mets.name \">\" 5}}{{#compare frm_nuclear_cardiolo_1.mets.name \"<=\" 7}}normal{{/compare}}{{#compare frm_nuclear_cardiolo_1.mets.name \">\" 7}}{{#compare frm_nuclear_cardiolo_1.mets.name \"<=\" 9}}good{{/compare}}{{/compare}}{{#compare frm_nuclear_cardiolo_1.mets.name \">\" 9}}excellent{{/compare}}{{/compare}} exercise capacity.");
//		template.append("{{/if}}");
//		template.append("{{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure_type.value \"==\" \"5\"}}");
//		template.append("{{#if frm_nuclear_cardiolo_1.mets.value}}");
//		template.append("While exercise tolerance cannot be fully assessed due to the use of a Modified Bruce Protocol, the patient achieved {{frm_nuclear_cardiolo_1.mets.name}} METS, which is consistent with {{#compare frm_nuclear_cardiolo_1.mets.name \"<=\" 5}}reduced{{/compare}}{{#compare frm_nuclear_cardiolo_1.mets.name \">\" 5}}{{#compare frm_nuclear_cardiolo_1.mets.name \"<=\" 7}}normal{{/compare}}{{#compare frm_nuclear_cardiolo_1.mets.name \">\" 7}}{{#compare frm_nuclear_cardiolo_1.mets.name \"<=\" 9}}good{{/compare}}{{/compare}}{{#compare frm_nuclear_cardiolo_1.mets.name \">\" 9}}excellent{{/compare}}{{/compare}} exercise capacity.");
//		template.append("{{/if}}");
//		template.append("{{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.interpretation.value \"!==\" \"no1\"}}");
//		template.append("    {{#compare frm_nuclear_cardiolo_1.interpretation.value \"!==\" \"no2\"}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.interpretation.value \"!==\" \"0\"}}");
//		template.append("            {{#compare frm_nuclear_cardiolo_1.interpretation.value \"!==\" \"sug\"}}");
//		template.append("                {{#if frm_nuclear_cardiolo_1.interpretation.value}}The ECG was {{frm_nuclear_cardiolo_1.interpretation.name}}. {{/if}}");
//		template.append("            {{/compare}}");
//		template.append("        {{/compare}}");
//		template.append("    {{/compare}}");
//		template.append("{{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.interpretation.value \"==\" \"no1\"}}The ECG demonstrated {{frm_nuclear_cardiolo_1.interpretation.name}}. {{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.interpretation.value \"==\" \"no2\"}}The ECG demonstrated {{frm_nuclear_cardiolo_1.interpretation.name}}. {{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.interpretation.value \"==\" \"sug\"}}The ECG was suggestive but nondiagnostic for ischemia. {{/compare}}");
//		template.append("{{frm_nuclear_cardiolo_1.stress_conclusion_req_comment}}");
//		template.append("{{frm_nuclear_cardiolo_1.stress_conclusion_comment}}");
//		template.append("");
//		template.append("{{#if frm_nuclear_cardiolo_1.staff_nuclear_cardiologist.name}}");
//		template.append("    {{#if frm_nuclear_cardiolo_1.interpretation.value}}");
//		template.append("        {{#compare frm_nuclear_cardiolo_1.procedure \"==\" \"procMPI\"}}");
//		template.append("            {{#compare frm_nuclear_cardiolo_1.procedure_type.value \"!==\" \"1\"}}(Interpretation by {{frm_nuclear_cardiolo_1.staff_nuclear_cardiologist.name}}.) {{/compare}}");
//		template.append("        {{else}}");
//		template.append("            {{#compare frm_nuclear_cardiolo_1.procedure \"==\" \"procNIETT\"}}(Interpretation by {{frm_nuclear_cardiolo_1.staff_nuclear_cardiologist.name}}.) {{/compare}}");
//		template.append("        {{/compare}}");
//		template.append("    {{/if}}");
//		template.append("{{/if}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.procedure \"==\" \"procGBPS\"}}{{#compare frm_nuclear_cardiolo_1.all_wnl.value \"==\" \"1\"}}{{#compare frm_nuclear_cardiolo_1.equivocal.value \"!==\" \"1\"}}The results of the study demonstrate normal LV size and function at rest. The images are within normal limits.");
//		template.append("{{/compare}}{{/compare}}{{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.conclusion_template.value \"==\" \"ischem\"}}");
//		template.append("The myocardial perfusion images demonstrate a {{frm_nuclear_cardiolo_1.conc_ischem_size.name}} {{frm_nuclear_cardiolo_1.conc_ischem_change.name}} {{frm_nuclear_cardiolo_1.conc_ischem_zone.name}} defect indicative of {{frm_nuclear_cardiolo_1.conc_ischem_indicates.name}} ischemia.");
//		template.append("{{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.conclusion_template.value \"==\" \"infarct\"}}");
//		template.append("The myocardial perfusion images demonstrate a {{frm_nuclear_cardiolo_1.conc_infarct_zone.name}} defect consistent with prior {{frm_nuclear_cardiolo_1.conc_infarct_prior.name}} with {{frm_nuclear_cardiolo_1.conc_infarct_severity.name}} myocardium but no stress induced ischemia.");
//		template.append("{{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.conclusion_template.value \"==\" \"same\"}}");
//		template.append("Compared to the report of the study of {{frm_nuclear_cardiolo_1.conc_same_comp}} with {{frm_nuclear_cardiolo_1.conc_same_test.name}} stress, the images are unchanged at {{frm_nuclear_cardiolo_1.conc_same_diff.name}} RPP.");
//		template.append("{{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.conclusion_template.value \"==\" \"worse\"}}");
//		template.append("Compared to the report of the study of {{frm_nuclear_cardiolo_1.conc_worse_comp}} with {{frm_nuclear_cardiolo_1.conc_worse_test.name}} stress, the anterior {{frm_nuclear_cardiolo_1.conc_worse_zone.name}} defect is now at {{frm_nuclear_cardiolo_1.conc_worse_diff.name}} RPP.");
//		template.append("{{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.conclusion_template.value \"==\" \"better\"}}");
//		template.append("Compared to the report of the study of {{frm_nuclear_cardiolo_1.conc_better_comp}} with {{frm_nuclear_cardiolo_1.conc_better_test.name}} stress, previously noted {{frm_nuclear_cardiolo_1.conc_better_zone.name}} defect {{frm_nuclear_cardiolo_1.conc_better_status.name}} at {{frm_nuclear_cardiolo_1.conc_better_diff.name}} RPP.");
//		template.append("{{/compare}}");
//		template.append("{{#compare frm_nuclear_cardiolo_1.conclusion_template.value \"==\" \"mild\"}}");
//		template.append("Mild {{frm_nuclear_cardiolo_1.conc_mild_zone.name}} thinning is not clearly outside normal limits.");
//		template.append("{{/compare}}");
//		template.append("{{frm_nuclear_cardiolo_1.conc_further_comments}}");
//		template.append("</p>");
//		template.append("");
//		template.append("<!-- ---------------- -->");
//		template.append("<!-- CRITICAL RESULTS -->");
//		template.append("<!-- ---------------- -->");
//		template.append("");
//		template.append("{{#compare frm_nuclear_cardiolo_1.critical_result.value \"==\" \"1\"}}<hr style=\"display:none\"><br><strong>Critical Test Result</strong><BR>");
//		template.append("    <div style=\"margin-left: 2em;\">");
//		template.append("{{#getNode frm_nuclear_cardiolo_1.critical_results_composite 'st_elevation'}}{{#if this.value}}");
//		template.append("The patient's test result meets criteria for the following critical value: {{else}}");
//		template.append("{{#getNode ../../frm_nuclear_cardiolo_1.critical_results_composite 'vt_vf'}}{{#if this.value}}");
//		template.append("The patient's test result meets criteria for the following critical value: {{else}}");
//		template.append("{{#getNode ../../../../frm_nuclear_cardiolo_1.critical_results_composite 'ant_ischemia_scan'}}{{#if this.value}}");
//		template.append("The patient's test result meets criteria for the following critical value: {{else}}");
//		template.append("{{#getNode ../../../../../../frm_nuclear_cardiolo_1.critical_results_composite 'pos_ecg_scan'}}{{#if this.value}}");
//		template.append("The patient's test result meets criteria for the following critical value: {{else}}");
//		template.append("{{#getNode ../../../../../../../../frm_nuclear_cardiolo_1.critical_results_composite 'pos_ecg_clinical'}}{{#if this.value}}");
//		template.append("The patient's test result meets criteria for the following critical value: {{else}}");
//		template.append("{{/if}}{{/getNode}}{{/if}}{{/getNode}}{{/if}}{{/getNode}}{{/if}}{{/getNode}}{{/if}}{{/getNode}}");
//		template.append("{{#getNode frm_nuclear_cardiolo_1.critical_results_composite 'st_elevation'}}{{#if this.value}}");
//		template.append("at least 1 mm horizontal ST segment elevation in two contiguous leads during stress, when those leads are normal at baseline. Other ECG and clinical evidence of severe myocardial ischemia may or may not be present.");
//		template.append("{{/if}}{{/getNode}}");
//		template.append("{{#getNode frm_nuclear_cardiolo_1.critical_results_composite 'vt_vf'}}{{#if this.value}}");
//		template.append("sustained VT, VF or other arrhythmia resulting in hemodynamic compromise or potential compromise if not immediately treated.");
//		template.append("{{/if}}{{/getNode}}");
//		template.append("{{#getNode frm_nuclear_cardiolo_1.critical_results_composite 'ant_ischemia_scan'}}{{#if this.value}}");
//		template.append("evidence of severe anterior ischemia on myocardial perfusion images.");
//		template.append("{{/if}}{{/getNode}}");
//		template.append("{{#getNode frm_nuclear_cardiolo_1.critical_results_composite 'pos_ecg_scan'}}{{#if this.value}}");
//		template.append("markedly positive ECG response to stress at low heart rate and workload in association with moderate/severe ischemia, any territory, on myocardial perfusion images.");
//		template.append("{{/if}}{{/getNode}}");
//		template.append("{{#getNode frm_nuclear_cardiolo_1.critical_results_composite 'pos_ecg_clinical'}}{{#if this.value}}");
//		template.append("markedly positive ECG response to stress at low heart rate and workload in association with decline in patients arterial pressure or anginal pain or equivalent (imaging or non-imaging stress test).");
//		template.append("{{/if}}{{/getNode}}");
//		template.append("<TABLE>");
//		template.append("  <TR>");
//		template.append("    <TD COLSPAN=\"4\"><strong>MD(s) Notified: {{frm_nuclear_cardiolo_1.md_name}} &nbsp;&nbsp;&nbsp;{{#if frm_nuclear_cardiolo_1.md_name2}}{{frm_nuclear_cardiolo_1.md_name2}} &nbsp;&nbsp;&nbsp;{{/if}}{{#if frm_nuclear_cardiolo_1.md_name3}}{{frm_nuclear_cardiolo_1.md_name3}} &nbsp;&nbsp;&nbsp;{{/if}}");
//		template.append("</strong></TD>");
//		template.append("  </TR>");
//		template.append("  <TR>");
//		template.append("    <TD><strong>Event Time: </strong>{{frm_nuclear_cardiolo_1.event_date}} &nbsp;&nbsp;&nbsp;{{frm_nuclear_cardiolo_1.event_time}}</TD>");
//		template.append("    <TD> &nbsp;&nbsp;&nbsp;</TD>");
//		template.append("    <TD><strong>Time Notified: </strong>{{frm_nuclear_cardiolo_1.md_notified_date}} &nbsp;&nbsp;&nbsp;{{frm_nuclear_cardiolo_1.md_notified_date}}</TD>");
//		template.append("  </TR>");
//		template.append("  <TR>");
//		template.append("    <TD COLSPAN=\"4\">{{#compare frm_nuclear_cardiolo_1.action_taken.value \"==\" \"EW\"}}After appropriate immediate treatment and stabilization, the patient was transferred to the MGH Emergency Ward.{{/compare}}");
//		template.append("      {{#compare frm_nuclear_cardiolo_1.action_taken.value \"==\" \"Admit\"}}After consultation with the patient's attending or covering physician, the patient was escorted to the MGH admitting office for direct admission.{{/compare}}");
//		template.append("      {{#compare frm_nuclear_cardiolo_1.action_taken.value \"==\" \"Office\"}}After consultation with the patient's attending or covering physician, the patient was advised to proceed to the attending's office for further evaluation.{{/compare}}");
//		template.append("      {{#compare frm_nuclear_cardiolo_1.action_taken.value \"==\" \"Home\"}}After consultation with the patient's attending or covering physician, the patient was advised to return home for later follow up with his/her attending physician.{{/compare}} {{frm_nuclear_cardiolo_1.critical_result_notification_comment}}</TD>");
//		template.append("  </TR>");
//		template.append("  <TR>");
//		template.append("    <TD COLSPAN=\"4\"></TD>");
//		template.append("  </TR>");
//		template.append("  {{#compare frm_nuclear_cardiolo_1.critical_result_verification.value \"==\" \"1\"}}<TR>");
//		template.append("    <TD COLSPAN=\"4\">The entire critical test result, including the patient's full name and medical record number, was read back by the receiving individual and verified that the test result was correct.</TD>");
//		template.append("  </TR>{{/compare}}");
//		template.append("</TABLE>");
//		template.append("</div><br>");
//		template.append("</p>");
//		template.append("{{/compare}}");
//		template.append("");
//		template.append("<!-- ---------- -->");
//		template.append("<!-- SIGNATURES -->");
//		template.append("<!-- ---------- -->");
//		template.append("");
//		template.append("</p>");
//		template.append("{{#if frm_nuclear_cardiolo_1.staff_card_signature_token}}<hr style=\"display:none\">{{#compare frm_nuclear_cardiolo_1.procedure_code \"!==\" \"STRESS100\"}}{{#compare frm_nuclear_cardiolo_1.procedure_code \"!==\" \"STRESS102\"}}We{{else}}I{{/compare}}{{else}}I{{/compare}} have personally reviewed the data relevant to the interpretation of this study.</p>");
//		template.append("<div style=\"margin-left: 2em;\">");
//		template.append("{{#if frm_nuclear_cardiolo_1.staff_card_signature_token}}");
//		template.append("<strong>Cardiologist:</strong> Signed by {{frm_nuclear_cardiolo_1.staff_nuclear_cardiologist.name}} on {{frm_nuclear_cardiolo_1.staff_card_signature_dateTime}}{{else}}{{/if}}<br>");
//		template.append("{{#if frm_nuclear_cardiolo_1.staff_rad_signature_token}}<strong>Radiologist:</strong> Signed by {{frm_nuclear_cardiolo_1.staff_radiologist.name}} on {{frm_nuclear_cardiolo_1.staff_rad_signature_dateTime}}{{else}}{{/if}}");
//		template.append("</div>");
//		template.append("</p>");
//		template.append("{{/if}}");



//        template.append("{{#compare frm_nuclear_cardiolo_1.procedure_code \"!==\" \"STRESS100\"}}{{#compare frm_nuclear_cardiolo_1.procedure_code \"!==\" \"STRESS102\"}}We{{else}}I{{/compare}}{{else}}I{{/compare}} have personally reviewed the data relevant to the interpretation of this study.</p>");


    }
}
